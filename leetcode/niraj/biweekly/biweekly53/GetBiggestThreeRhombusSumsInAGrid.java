package biweekly.biweekly53;

import java.util.*;

/**
 * Created on:  May 29, 2021
 * Questions: https://leetcode.com/contest/biweekly-contest-53/problems/get-biggest-three-rhombus-sums-in-a-grid/
 */

public class GetBiggestThreeRhombusSumsInAGrid {

    public static void main(String[] args) {
        System.out.println("************************** Solution 1 **************************");
        System.out.println(Arrays.toString(getBiggestThree(new int[][]{{3, 4, 5, 1, 3}, {3, 3, 4, 2, 3}, {20, 30, 200, 40, 10}, {1, 5, 5, 4, 1}, {4, 3, 2, 2, 5}})) + " = [228,216,211]");
        System.out.println(Arrays.toString(getBiggestThree(new int[][]{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}})) + " = [20,9,8]");
        System.out.println(Arrays.toString(getBiggestThree(new int[][]{{7}, {7}, {7}})) + " = [7]");
        System.out.println(Arrays.toString(getBiggestThree(new int[][]{{19208, 86603, 53855, 84930, 11075, 96167, 35091, 91664, 29122, 60474, 69666, 65246, 3192, 83837, 19037, 66353, 59133, 13649, 4589, 96828, 95045, 30462, 8445, 94132, 3955, 77361, 52762, 58966, 67583, 27822, 89221, 45311, 70352, 65549}, {62887, 25964, 18497, 11048, 44404, 31110, 45339, 80140, 91029, 82377, 61192, 63594, 41719, 85983, 88986, 34372, 36182, 53564, 28887, 6537, 12408, 2820, 476, 92391, 8592, 29128, 4028, 75931, 41876, 55204, 7712, 92815, 11032, 53962}, {32451, 52485, 69751, 72731, 98394, 88499, 10505, 29824, 94566, 706, 47481, 88721, 8022, 61943, 67821, 45928, 66243, 19931, 83405, 97742, 68433, 88967, 2246, 43142, 69376, 32720, 34240, 1446, 20365, 9414, 65876, 25318, 9, 88553}, {11299, 44998, 89177, 88142, 44149, 76423, 5707, 82698, 87401, 95061, 64119, 38852, 46408, 16558, 8515, 89915, 92760, 80063, 10816, 58522, 54307, 18475, 42900, 9958, 62279, 97829, 30552, 51845, 48658, 99572, 11760, 55827, 86075, 2050}, {42402, 59427, 10387, 37144, 86962, 3309, 90590, 8727, 29951, 80983, 73648, 36021, 62632, 20955, 80859, 96500, 81933, 97615, 30395, 20484, 49442, 95797, 28859, 79288, 86480, 12531, 20763, 62545, 26461, 56859, 43510, 91501, 62512, 55722}, {10310, 84893, 20712, 15398, 92864, 9366, 14189, 81675, 8404, 27423, 34282, 99915, 84024, 25002, 69366, 932, 1088, 60880, 88463, 80762, 74066, 62600, 14302, 61670, 84360, 36058, 41386, 81293, 56981, 36020, 57663, 70869, 94009, 31491}, {75007, 70642, 74213, 52271, 80372, 11345, 94159, 39535, 35250, 62821, 68161, 22100, 82697, 68913, 35167, 57935, 26543, 81626, 60217, 81991, 10796, 82333, 66078, 3455, 57358, 12563, 51404, 44839, 63391, 23980, 11158, 31928, 83971, 52981}, {63719, 49282, 64209, 68941, 27678, 29590, 98804, 45079, 56372, 32902, 20296, 27750, 32360, 26753, 64435, 25484, 10394, 16331, 95995, 99548, 17909, 86378, 46275, 63087, 93955, 30665, 47837, 74548, 10861, 50362, 87391, 88137, 31870, 49722}, {96895, 54450, 41417, 23061, 10443, 34574, 33832, 74157, 24347, 5557, 56429, 89296, 61060, 19242, 18755, 68988, 80074, 86861, 98175, 36747, 25939, 84566, 74369, 68801, 79095, 91109, 2556, 29641, 61072, 33499, 7657, 43269, 23258, 44897}, {49581, 23685, 73970, 23631, 70137, 12743, 54264, 84559, 22546, 45597, 80915, 37389, 56786, 40936, 39671, 49819, 80912, 19204, 73995, 29218, 6757, 18033, 8931, 20348, 40750, 34970, 59523, 81558, 97572, 49754, 7006, 97705, 46217, 62217}, {54424, 26255, 94948, 48716, 39637, 12424, 22895, 55629, 38377, 38364, 43761, 95302, 79912, 16991, 59, 44487, 93304, 67502, 45215, 53495, 95391, 29089, 4507, 69453, 74208, 35313, 70798, 924, 41409, 29395, 32420, 88899, 82771, 72971}, {60844, 7805, 24525, 20467, 7831, 95208, 29794, 37951, 71540, 35937, 40859, 6411, 72694, 24201, 99153, 28765, 56159, 7899, 18356, 87240, 72651, 39209, 76991, 926, 70752, 92717, 50469, 48788, 47042, 33497, 18149, 18097, 3426, 29453}, {91100, 88882, 43797, 75702, 80324, 54820, 14556, 98865, 9304, 58038, 81479, 18612, 82922, 82371, 14121, 94095, 61812, 58520, 35127, 91850, 6347, 4252, 4489, 93311, 85981, 19662, 93122, 68312, 59265, 19553, 79505, 34778, 64741, 54762}, {59121, 7461, 97838, 45830, 47116, 79664, 76772, 19734, 13087, 77639, 58569, 45030, 39700, 21760, 25839, 74053, 96787, 19782, 55756, 1031, 54247, 92317, 89181, 59344, 45306, 58884, 62039, 11010, 12995, 48983, 76012, 52199, 92422, 72611}, {63032, 47152, 24773, 15739, 88999, 41163, 83593, 86112, 55360, 56424, 41787, 13303, 69324, 6803, 27006, 58726, 62730, 47084, 78330, 23934, 91998, 13838, 41206, 61883, 94198, 2936, 60864, 66411, 95929, 17504, 89316, 49112, 38207, 42232}, {86822, 98206, 9906, 5732, 45848, 55278, 26373, 59604, 91019, 68848, 97972, 95090, 30311, 127, 43505, 81639, 93301, 72210, 87282, 56683, 96574, 60075, 5397, 62255, 74120, 17008, 22794, 34797, 24839, 17125, 10919, 20897, 73113, 10870}, {8779, 5622, 63301, 55462, 40328, 84077, 69269, 21274, 97016, 16556, 59037, 91557, 58824, 68042, 35308, 38512, 72511, 33288, 41583, 92603, 58408, 74229, 44313, 86444, 26018, 13310, 98001, 26998, 54148, 4614, 53082, 49454, 37599, 38351}, {96074, 99674, 88844, 82337, 18902, 9826, 28098, 522, 35008, 85725, 26451, 14087, 96722, 86051, 20969, 38649, 6375, 90804, 16269, 21400, 21040, 45164, 25142, 11105, 24107, 2979, 28783, 49918, 40376, 97950, 27259, 97045, 13898, 84727}, {57324, 30874, 51269, 1801, 78535, 41855, 55525, 43660, 84497, 33950, 61385, 98621, 61701, 90019, 64164, 54686, 83741, 2365, 18417, 91371, 30012, 10197, 35754, 32133, 64705, 53104, 96636, 10327, 5621, 58370, 51662, 32272, 3802, 37172}, {34548, 58116, 47827, 93377, 7663, 50519, 90161, 84838, 85473, 55657, 5688, 85524, 71082, 80354, 38523, 75397, 20770, 67392, 93192, 86929, 46958, 51254, 65938, 8262, 34794, 17151, 68818, 8622, 8034, 3106, 91389, 29666, 30458, 83109}, {36008, 35216, 4853, 16936, 51723, 83642, 93428, 31388, 91740, 41875, 52374, 53348, 17657, 9383, 80949, 89187, 77872, 87891, 51226, 13671, 65280, 77665, 33033, 95298, 81762, 87654, 52449, 49009, 86056, 58833, 5343, 20511, 23390, 9025}, {5798, 54187, 31962, 25128, 72971, 6715, 40589, 57938, 6340, 46741, 18763, 57436, 66367, 26451, 13438, 15582, 68277, 78827, 20977, 34006, 18374, 57390, 93568, 20472, 31789, 20024, 59643, 45586, 80907, 88463, 50143, 91382, 77307, 98672}, {76042, 54042, 90127, 46379, 87683, 70868, 3940, 80829, 77293, 43301, 80789, 35965, 94398, 23007, 54761, 56084, 20579, 71912, 5513, 79017, 98582, 77311, 86396, 11452, 52994, 84162, 12040, 27522, 25985, 37493, 50427, 8002, 19298, 80948}, {18991, 425, 15486, 60618, 94077, 40106, 95992, 86386, 73725, 72287, 73011, 23753, 66578, 78890, 91257, 38458, 72653, 76752, 65853, 31452, 38215, 55774, 24494, 98951, 24254, 74945, 73954, 9821, 98279, 90044, 12077, 30540, 72899, 59208}, {60822, 16252, 46137, 34334, 10865, 77792, 69316, 52990, 53384, 76989, 97125, 42755, 85262, 88134, 62513, 60825, 71457, 6605, 78555, 16311, 76824, 21583, 45890, 1635, 29938, 35467, 46486, 83048, 84915, 43336, 24379, 45189, 27914, 64539}, {94919, 87043, 16891, 77266, 18613, 78614, 38556, 80931, 51320, 75642, 21289, 52275, 34245, 75930, 66771, 49607, 54865, 28415, 12603, 70560, 8676, 67350, 45443, 68502, 29792, 75215, 90572, 62299, 27280, 70146, 82867, 17789, 40154, 53757}, {50519, 54389, 80877, 18170, 92167, 57407, 88045, 89993, 77609, 91236, 28480, 21725, 43477, 99604, 3702, 81376, 77010, 49530, 76769, 11069, 30712, 30572, 38883, 3003, 26029, 91266, 56445, 27712, 117, 94347, 98130, 73808, 85383, 19054}, {64346, 22587, 45749, 53960, 27765, 89743, 85435, 91358, 95117, 89278, 58353, 27262, 9065, 36343, 59190, 26926, 27832, 28934, 793, 66716, 76048, 54617, 53327, 49872, 62795, 96849, 99623, 73083, 98294, 10106, 47957, 26732, 81590, 51875}, {31816, 49835, 39777, 24880, 73854, 51322, 47655, 45060, 13727, 87926, 90434, 1815, 43412, 93951, 89967, 70641, 3450, 60441, 10677, 27464, 70771, 9930, 5902, 33995, 94443, 97450, 89047, 92092, 51220, 37767, 35300, 99407, 39615, 77322}, {47090, 16131, 72211, 59270, 45886, 61329, 89456, 79245, 64513, 48690, 87973, 78007, 59425, 28002, 38188, 21989, 7181, 12017, 62724, 35329, 67666, 13525, 40852, 94797, 64027, 91550, 22533, 96830, 62503, 9946, 2326, 97383, 32585, 54947}, {30138, 89253, 76939, 86049, 97683, 62087, 86626, 98210, 61180, 16842, 46395, 9551, 98004, 59494, 4812, 38066, 37615, 61472, 33011, 48208, 16127, 58921, 9177, 24220, 126, 17077, 59583, 94147, 28917, 6831, 21609, 79722, 7546, 88471}, {78997, 74245, 92749, 44592, 61833, 57344, 10462, 62081, 56251, 45570, 72543, 86687, 10200, 40258, 37488, 7120, 61480, 49159, 832, 7254, 78098, 82462, 83129, 33450, 89445, 61299, 15425, 1960, 14276, 95780, 71020, 52537, 74321, 16154}, {69182, 22290, 23767, 72833, 44825, 28116, 34344, 99017, 59531, 53966, 14614, 80239, 54115, 4282, 92666, 85800, 68158, 19923, 65301, 28819, 42064, 24798, 20929, 44510, 73803, 10681, 11316, 3937, 14994, 89261, 5113, 19187, 3415, 10150}, {78419, 61687, 71501, 6031, 67056, 12301, 8580, 29136, 29455, 68640, 31139, 60039, 12896, 36920, 14922, 23919, 83811, 61294, 786, 26934, 37680, 63798, 89317, 47264, 2611, 92364, 5588, 32081, 48463, 78932, 39441, 44184, 18111, 41724}, {89038, 58904, 70710, 28265, 42879, 53858, 13899, 62680, 97604, 66386, 76637, 46874, 13110, 74118, 29859, 30806, 14236, 65964, 21615, 79685, 58273, 68909, 71025, 41774, 57584, 32288, 56600, 7719, 6046, 3720, 99485, 34649, 46618, 79681}})) +
                " = [3495660, 3383930, 3378048]");
        System.out.println(Arrays.toString(getBiggestThree(new int[][]{{40491, 21743, 69338, 78086, 63528, 87349, 13584, 80870, 26220, 78462, 46644, 24163, 88244, 22781, 49564, 95979, 1728, 26243, 45097, 71815, 13862, 48706, 70335, 38018, 56363, 5975, 54520, 57594, 45682, 81805, 1433, 46494, 88093, 7334, 75835, 86420, 14143, 73064, 4188, 46466, 54827, 51504, 14926, 73299, 96440}, {35576, 67019, 96918, 84956, 10459, 12411, 84853, 45654, 23573, 86967, 4519, 41913, 9132, 7551, 8831, 54543, 34646, 61133, 88497, 13728, 81860, 92597, 80131, 52687, 94386, 58656, 87750, 76734, 71300, 1708, 41707, 84361, 35000, 47666, 97134, 73096, 65527, 51960, 62315, 50046, 92726, 59527, 24760, 66115, 5255}, {68195, 58239, 39029, 81954, 58622, 53582, 64116, 27448, 82071, 78745, 64779, 44095, 53078, 80045, 81475, 57586, 76681, 73191, 538, 92492, 61902, 92554, 52488, 58462, 22321, 69909, 77690, 92824, 84135, 99301, 73590, 45120, 2699, 55464, 96789, 51418, 80074, 2759, 33220, 32942, 38996, 57129, 79363, 97891, 36312}, {3125, 79216, 24458, 34671, 30603, 75564, 55386, 81443, 44438, 82550, 95892, 99537, 85509, 20089, 86430, 27811, 54535, 71064, 74031, 51463, 76021, 99220, 46734, 13152, 33719, 34218, 52041, 79150, 68360, 18393, 21782, 50996, 69081, 95524, 42728, 18435, 96530, 11203, 18371, 56821, 74892, 65963, 292, 12474, 80038}, {86264, 30713, 56708, 27011, 11594, 24030, 30538, 99715, 79073, 94322, 17739, 55675, 97638, 52076, 67210, 29639, 36394, 12742, 42308, 36869, 39864, 45908, 55378, 89610, 5848, 38122, 34607, 55270, 49849, 86425, 45025, 71278, 74872, 73009, 81527, 3714, 25489, 75412, 98993, 79224, 65801, 18116, 12116, 21420, 59933}, {4361, 20279, 76433, 9922, 70791, 41088, 70486, 73809, 8132, 83561, 39181, 97947, 37941, 85297, 11490, 29533, 4315, 53034, 80195, 99057, 94709, 14597, 72779, 37228, 37005, 20247, 59205, 59563, 84728, 27215, 24536, 85111, 88938, 27359, 10689, 39889, 56023, 13687, 99520, 63842, 85973, 70754, 63923, 44406, 61584}, {5661, 74219, 65545, 38533, 88545, 63512, 31337, 52435, 93441, 70680, 82777, 72186, 96102, 81938, 36871, 80959, 69801, 80987, 20178, 81724, 23182, 68891, 88887, 26061, 48690, 17648, 11251, 20689, 2195, 53679, 97684, 97063, 51603, 30029, 32547, 8180, 88362, 49255, 2919, 20263, 69290, 95743, 62220, 50442, 19859}, {6907, 68140, 62674, 90272, 54540, 24170, 31479, 55831, 39699, 34589, 44303, 25628, 648, 99954, 86833, 23517, 41323, 67535, 86668, 89767, 5662, 81219, 48080, 19305, 50828, 2366, 30946, 1739, 59572, 69585, 13140, 42586, 75493, 46684, 89700, 30743, 44999, 26284, 47262, 82285, 54604, 94574, 26811, 64430, 70967}, {66249, 18235, 57289, 30368, 14832, 89818, 58070, 11253, 87399, 86080, 19652, 29068, 15516, 79294, 48598, 30580, 82873, 45121, 8531, 52763, 87418, 50292, 61188, 93391, 31681, 2850, 30270, 97136, 46961, 21509, 93741, 47964, 39668, 92827, 82287, 95672, 17705, 48857, 29400, 78390, 79699, 65710, 28195, 5377, 9914}, {42597, 49126, 65669, 98491, 32215, 1909, 64094, 18571, 36245, 98887, 7247, 10253, 87913, 25498, 90222, 64044, 15331, 61207, 40515, 46592, 6189, 4641, 2228, 35259, 95, 52283, 79379, 51213, 56843, 64918, 77123, 57491, 82267, 16140, 64921, 21289, 39460, 74565, 75175, 24092, 69121, 70769, 99664, 46516, 52116}, {57178, 41884, 36329, 55016, 22609, 84057, 25262, 44472, 38804, 48125, 83602, 53344, 30138, 27694, 5365, 65411, 82840, 23196, 84582, 36681, 76749, 95981, 97206, 98831, 18701, 57264, 2111, 55828, 51789, 22503, 20646, 12, 89311, 35058, 93305, 35340, 99971, 19035, 22830, 79106, 75808, 36853, 94095, 6209, 59564}, {26247, 69478, 21553, 49292, 26846, 18035, 65597, 12878, 54821, 35732, 60973, 71281, 94578, 40676, 39631, 89857, 23604, 2004, 22139, 85017, 30635, 40945, 99872, 92067, 66893, 72420, 22589, 91655, 15017, 7494, 49923, 65330, 7056, 16181, 45912, 26817, 3654, 65139, 45428, 4190, 68174, 47117, 1778, 98908, 12104}, {68716, 27185, 96113, 26174, 19754, 64506, 92301, 248, 10559, 77861, 64853, 6573, 62458, 7973, 64395, 90911, 18357, 1253, 71509, 91917, 68050, 72834, 42262, 17340, 99551, 60449, 75335, 41009, 67611, 44150, 69526, 28095, 63, 81782, 33132, 27027, 69265, 4132, 10655, 68422, 50800, 74408, 80520, 88777, 3681}, {6009, 87774, 87408, 32301, 29931, 94685, 43865, 63724, 78308, 93193, 2722, 80768, 62862, 72726, 45513, 97225, 61957, 60282, 31788, 94095, 38063, 16950, 83675, 72107, 78501, 16719, 27400, 13754, 88278, 54508, 48259, 89776, 217, 65375, 87489, 7876, 40253, 56231, 60604, 40436, 68951, 72718, 51035, 5631, 16970}, {68356, 3388, 86, 2465, 84912, 33058, 6953, 43173, 32035, 41609, 8272, 80932, 82702, 86155, 49007, 59988, 57754, 11101, 62530, 10794, 79841, 8102, 50306, 13171, 31394, 75734, 35939, 87910, 7171, 62245, 97315, 98949, 69772, 36394, 66411, 36515, 10621, 10111, 26292, 3574, 71153, 84176, 2521, 8153, 93067}, {14117, 9505, 64900, 91858, 11070, 57278, 58256, 10182, 90685, 24451, 83756, 15318, 25621, 15779, 24925, 3410, 60554, 33046, 73253, 66475, 88541, 98933, 32906, 21093, 80743, 29407, 6778, 84967, 34711, 71653, 48831, 18167, 23804, 76545, 42213, 21679, 17301, 79490, 97173, 98242, 82811, 23743, 32707, 27372, 97596}, {79389, 27530, 6754, 9485, 49237, 60059, 87291, 74076, 60586, 98695, 609, 44755, 76152, 54682, 21249, 82561, 38468, 46980, 92099, 35964, 17685, 26496, 23735, 11880, 9866, 41232, 88604, 64976, 71112, 14984, 17021, 78602, 78240, 16032, 56917, 69380, 31114, 93960, 53387, 28507, 60677, 26308, 67759, 62173, 65590}, {74196, 47469, 4089, 68042, 75210, 60861, 30270, 60145, 41443, 65944, 11041, 59709, 24839, 99552, 44759, 22548, 36018, 8297, 31805, 61148, 13036, 12618, 76145, 60010, 46313, 88161, 12815, 42856, 74479, 28434, 98442, 79319, 35641, 28217, 74407, 92461, 23174, 24010, 28275, 42793, 27644, 95328, 57651, 57013, 71104}, {98563, 15164, 45710, 99498, 19757, 95443, 3766, 63063, 56835, 14171, 68156, 57917, 63334, 89611, 4682, 65654, 17456, 61359, 97493, 24984, 35613, 77835, 56179, 70265, 88952, 36085, 89337, 70763, 47004, 5970, 11182, 29285, 25198, 16793, 91522, 24452, 17954, 95472, 16055, 88759, 66721, 97150, 90858, 91991, 55418}, {24849, 98455, 26381, 8009, 2755, 78498, 19056, 44011, 72988, 8198, 56340, 92176, 69849, 71421, 70478, 70647, 13472, 5831, 43992, 54406, 7209, 79965, 33989, 30275, 56687, 70848, 1954, 24525, 92637, 54706, 17791, 42622, 96599, 47363, 21316, 86081, 95521, 31973, 27913, 20569, 16336, 1732, 82473, 69128, 16243}, {24433, 29166, 88525, 99756, 62893, 20754, 71955, 24467, 83320, 59310, 62920, 70725, 56635, 93877, 38935, 6910, 40285, 78295, 90378, 33757, 50924, 22630, 79980, 39244, 73496, 77806, 35440, 85567, 4844, 91237, 2539, 55016, 90118, 89724, 54213, 77173, 59086, 43465, 18073, 10899, 63786, 95539, 28757, 33142, 67791}, {47463, 63854, 95970, 4279, 97683, 49776, 48990, 24221, 74269, 10239, 77919, 46824, 91171, 17033, 29105, 43741, 82904, 75036, 26348, 31125, 95216, 68038, 33014, 39926, 79723, 45477, 4310, 37680, 66752, 27848, 88818, 55363, 54444, 59991, 885, 39361, 71347, 66217, 8454, 35102, 76270, 25506, 87848, 63211, 94505}, {22229, 94776, 14418, 56023, 39555, 92621, 72743, 8607, 6318, 90223, 60032, 77615, 60675, 52155, 78553, 30644, 75925, 95384, 38832, 24154, 10545, 73317, 62691, 59384, 98137, 70512, 56566, 74322, 44260, 4577, 39469, 50724, 13821, 89722, 27586, 88954, 72126, 4013, 88849, 13258, 83057, 47165, 65617, 86217, 26911}, {11258, 58391, 23369, 40666, 5593, 43980, 27452, 70421, 10526, 30519, 18950, 96759, 41871, 72721, 377, 73221, 65910, 65554, 64295, 14923, 74312, 77627, 15292, 58289, 85423, 60864, 97643, 68836, 40902, 74197, 92050, 87992, 86527, 59775, 40192, 27069, 89482, 12000, 97663, 77879, 96918, 63426, 16059, 58690, 56425}, {90810, 47429, 60514, 43636, 72279, 4627, 82628, 5499, 83280, 33210, 89619, 32813, 33196, 49547, 22403, 59683, 30965, 98029, 49934, 81867, 58964, 58479, 2483, 51723, 61960, 98201, 34295, 45835, 8105, 67962, 89152, 51630, 69334, 50564, 74777, 45826, 28912, 65963, 15171, 70711, 8496, 55972, 19833, 9648, 94378}, {83428, 69112, 59112, 45405, 70608, 88615, 20460, 98613, 88660, 26684, 94855, 36760, 4565, 40759, 8161, 48988, 82145, 56644, 60434, 39664, 12810, 97300, 27189, 61011, 21762, 66457, 55182, 17102, 93836, 49978, 65868, 21225, 3452, 56782, 28691, 83540, 58994, 19762, 38996, 91286, 13871, 47129, 15491, 51512, 7659}, {695, 51225, 54612, 81859, 25670, 52092, 41512, 50638, 13598, 56030, 33956, 51227, 73191, 73570, 84179, 83918, 45986, 75951, 27664, 86091, 64147, 51178, 73860, 27632, 35712, 62954, 4048, 18956, 87813, 67093, 17863, 19792, 549, 8644, 92303, 68724, 28985, 72158, 26352, 51372, 6654, 29557, 26264, 71087, 53158}}
        )) + " = [2955471,2900947,2888411]");

        System.out.println("************************** Solution 2 **************************");
        System.out.println(Arrays.toString(getBiggestThree_rev2(new int[][]{{3, 4, 5, 1, 3}, {3, 3, 4, 2, 3}, {20, 30, 200, 40, 10}, {1, 5, 5, 4, 1}, {4, 3, 2, 2, 5}})) + " = [228,216,211]");
        System.out.println(Arrays.toString(getBiggestThree_rev2(new int[][]{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}})) + " = [20,9,8]");
        System.out.println(Arrays.toString(getBiggestThree_rev2(new int[][]{{7}, {7}, {7}})) + " = [7]");
        System.out.println(Arrays.toString(getBiggestThree_rev2(new int[][]{{19208, 86603, 53855, 84930, 11075, 96167, 35091, 91664, 29122, 60474, 69666, 65246, 3192, 83837, 19037, 66353, 59133, 13649, 4589, 96828, 95045, 30462, 8445, 94132, 3955, 77361, 52762, 58966, 67583, 27822, 89221, 45311, 70352, 65549}, {62887, 25964, 18497, 11048, 44404, 31110, 45339, 80140, 91029, 82377, 61192, 63594, 41719, 85983, 88986, 34372, 36182, 53564, 28887, 6537, 12408, 2820, 476, 92391, 8592, 29128, 4028, 75931, 41876, 55204, 7712, 92815, 11032, 53962}, {32451, 52485, 69751, 72731, 98394, 88499, 10505, 29824, 94566, 706, 47481, 88721, 8022, 61943, 67821, 45928, 66243, 19931, 83405, 97742, 68433, 88967, 2246, 43142, 69376, 32720, 34240, 1446, 20365, 9414, 65876, 25318, 9, 88553}, {11299, 44998, 89177, 88142, 44149, 76423, 5707, 82698, 87401, 95061, 64119, 38852, 46408, 16558, 8515, 89915, 92760, 80063, 10816, 58522, 54307, 18475, 42900, 9958, 62279, 97829, 30552, 51845, 48658, 99572, 11760, 55827, 86075, 2050}, {42402, 59427, 10387, 37144, 86962, 3309, 90590, 8727, 29951, 80983, 73648, 36021, 62632, 20955, 80859, 96500, 81933, 97615, 30395, 20484, 49442, 95797, 28859, 79288, 86480, 12531, 20763, 62545, 26461, 56859, 43510, 91501, 62512, 55722}, {10310, 84893, 20712, 15398, 92864, 9366, 14189, 81675, 8404, 27423, 34282, 99915, 84024, 25002, 69366, 932, 1088, 60880, 88463, 80762, 74066, 62600, 14302, 61670, 84360, 36058, 41386, 81293, 56981, 36020, 57663, 70869, 94009, 31491}, {75007, 70642, 74213, 52271, 80372, 11345, 94159, 39535, 35250, 62821, 68161, 22100, 82697, 68913, 35167, 57935, 26543, 81626, 60217, 81991, 10796, 82333, 66078, 3455, 57358, 12563, 51404, 44839, 63391, 23980, 11158, 31928, 83971, 52981}, {63719, 49282, 64209, 68941, 27678, 29590, 98804, 45079, 56372, 32902, 20296, 27750, 32360, 26753, 64435, 25484, 10394, 16331, 95995, 99548, 17909, 86378, 46275, 63087, 93955, 30665, 47837, 74548, 10861, 50362, 87391, 88137, 31870, 49722}, {96895, 54450, 41417, 23061, 10443, 34574, 33832, 74157, 24347, 5557, 56429, 89296, 61060, 19242, 18755, 68988, 80074, 86861, 98175, 36747, 25939, 84566, 74369, 68801, 79095, 91109, 2556, 29641, 61072, 33499, 7657, 43269, 23258, 44897}, {49581, 23685, 73970, 23631, 70137, 12743, 54264, 84559, 22546, 45597, 80915, 37389, 56786, 40936, 39671, 49819, 80912, 19204, 73995, 29218, 6757, 18033, 8931, 20348, 40750, 34970, 59523, 81558, 97572, 49754, 7006, 97705, 46217, 62217}, {54424, 26255, 94948, 48716, 39637, 12424, 22895, 55629, 38377, 38364, 43761, 95302, 79912, 16991, 59, 44487, 93304, 67502, 45215, 53495, 95391, 29089, 4507, 69453, 74208, 35313, 70798, 924, 41409, 29395, 32420, 88899, 82771, 72971}, {60844, 7805, 24525, 20467, 7831, 95208, 29794, 37951, 71540, 35937, 40859, 6411, 72694, 24201, 99153, 28765, 56159, 7899, 18356, 87240, 72651, 39209, 76991, 926, 70752, 92717, 50469, 48788, 47042, 33497, 18149, 18097, 3426, 29453}, {91100, 88882, 43797, 75702, 80324, 54820, 14556, 98865, 9304, 58038, 81479, 18612, 82922, 82371, 14121, 94095, 61812, 58520, 35127, 91850, 6347, 4252, 4489, 93311, 85981, 19662, 93122, 68312, 59265, 19553, 79505, 34778, 64741, 54762}, {59121, 7461, 97838, 45830, 47116, 79664, 76772, 19734, 13087, 77639, 58569, 45030, 39700, 21760, 25839, 74053, 96787, 19782, 55756, 1031, 54247, 92317, 89181, 59344, 45306, 58884, 62039, 11010, 12995, 48983, 76012, 52199, 92422, 72611}, {63032, 47152, 24773, 15739, 88999, 41163, 83593, 86112, 55360, 56424, 41787, 13303, 69324, 6803, 27006, 58726, 62730, 47084, 78330, 23934, 91998, 13838, 41206, 61883, 94198, 2936, 60864, 66411, 95929, 17504, 89316, 49112, 38207, 42232}, {86822, 98206, 9906, 5732, 45848, 55278, 26373, 59604, 91019, 68848, 97972, 95090, 30311, 127, 43505, 81639, 93301, 72210, 87282, 56683, 96574, 60075, 5397, 62255, 74120, 17008, 22794, 34797, 24839, 17125, 10919, 20897, 73113, 10870}, {8779, 5622, 63301, 55462, 40328, 84077, 69269, 21274, 97016, 16556, 59037, 91557, 58824, 68042, 35308, 38512, 72511, 33288, 41583, 92603, 58408, 74229, 44313, 86444, 26018, 13310, 98001, 26998, 54148, 4614, 53082, 49454, 37599, 38351}, {96074, 99674, 88844, 82337, 18902, 9826, 28098, 522, 35008, 85725, 26451, 14087, 96722, 86051, 20969, 38649, 6375, 90804, 16269, 21400, 21040, 45164, 25142, 11105, 24107, 2979, 28783, 49918, 40376, 97950, 27259, 97045, 13898, 84727}, {57324, 30874, 51269, 1801, 78535, 41855, 55525, 43660, 84497, 33950, 61385, 98621, 61701, 90019, 64164, 54686, 83741, 2365, 18417, 91371, 30012, 10197, 35754, 32133, 64705, 53104, 96636, 10327, 5621, 58370, 51662, 32272, 3802, 37172}, {34548, 58116, 47827, 93377, 7663, 50519, 90161, 84838, 85473, 55657, 5688, 85524, 71082, 80354, 38523, 75397, 20770, 67392, 93192, 86929, 46958, 51254, 65938, 8262, 34794, 17151, 68818, 8622, 8034, 3106, 91389, 29666, 30458, 83109}, {36008, 35216, 4853, 16936, 51723, 83642, 93428, 31388, 91740, 41875, 52374, 53348, 17657, 9383, 80949, 89187, 77872, 87891, 51226, 13671, 65280, 77665, 33033, 95298, 81762, 87654, 52449, 49009, 86056, 58833, 5343, 20511, 23390, 9025}, {5798, 54187, 31962, 25128, 72971, 6715, 40589, 57938, 6340, 46741, 18763, 57436, 66367, 26451, 13438, 15582, 68277, 78827, 20977, 34006, 18374, 57390, 93568, 20472, 31789, 20024, 59643, 45586, 80907, 88463, 50143, 91382, 77307, 98672}, {76042, 54042, 90127, 46379, 87683, 70868, 3940, 80829, 77293, 43301, 80789, 35965, 94398, 23007, 54761, 56084, 20579, 71912, 5513, 79017, 98582, 77311, 86396, 11452, 52994, 84162, 12040, 27522, 25985, 37493, 50427, 8002, 19298, 80948}, {18991, 425, 15486, 60618, 94077, 40106, 95992, 86386, 73725, 72287, 73011, 23753, 66578, 78890, 91257, 38458, 72653, 76752, 65853, 31452, 38215, 55774, 24494, 98951, 24254, 74945, 73954, 9821, 98279, 90044, 12077, 30540, 72899, 59208}, {60822, 16252, 46137, 34334, 10865, 77792, 69316, 52990, 53384, 76989, 97125, 42755, 85262, 88134, 62513, 60825, 71457, 6605, 78555, 16311, 76824, 21583, 45890, 1635, 29938, 35467, 46486, 83048, 84915, 43336, 24379, 45189, 27914, 64539}, {94919, 87043, 16891, 77266, 18613, 78614, 38556, 80931, 51320, 75642, 21289, 52275, 34245, 75930, 66771, 49607, 54865, 28415, 12603, 70560, 8676, 67350, 45443, 68502, 29792, 75215, 90572, 62299, 27280, 70146, 82867, 17789, 40154, 53757}, {50519, 54389, 80877, 18170, 92167, 57407, 88045, 89993, 77609, 91236, 28480, 21725, 43477, 99604, 3702, 81376, 77010, 49530, 76769, 11069, 30712, 30572, 38883, 3003, 26029, 91266, 56445, 27712, 117, 94347, 98130, 73808, 85383, 19054}, {64346, 22587, 45749, 53960, 27765, 89743, 85435, 91358, 95117, 89278, 58353, 27262, 9065, 36343, 59190, 26926, 27832, 28934, 793, 66716, 76048, 54617, 53327, 49872, 62795, 96849, 99623, 73083, 98294, 10106, 47957, 26732, 81590, 51875}, {31816, 49835, 39777, 24880, 73854, 51322, 47655, 45060, 13727, 87926, 90434, 1815, 43412, 93951, 89967, 70641, 3450, 60441, 10677, 27464, 70771, 9930, 5902, 33995, 94443, 97450, 89047, 92092, 51220, 37767, 35300, 99407, 39615, 77322}, {47090, 16131, 72211, 59270, 45886, 61329, 89456, 79245, 64513, 48690, 87973, 78007, 59425, 28002, 38188, 21989, 7181, 12017, 62724, 35329, 67666, 13525, 40852, 94797, 64027, 91550, 22533, 96830, 62503, 9946, 2326, 97383, 32585, 54947}, {30138, 89253, 76939, 86049, 97683, 62087, 86626, 98210, 61180, 16842, 46395, 9551, 98004, 59494, 4812, 38066, 37615, 61472, 33011, 48208, 16127, 58921, 9177, 24220, 126, 17077, 59583, 94147, 28917, 6831, 21609, 79722, 7546, 88471}, {78997, 74245, 92749, 44592, 61833, 57344, 10462, 62081, 56251, 45570, 72543, 86687, 10200, 40258, 37488, 7120, 61480, 49159, 832, 7254, 78098, 82462, 83129, 33450, 89445, 61299, 15425, 1960, 14276, 95780, 71020, 52537, 74321, 16154}, {69182, 22290, 23767, 72833, 44825, 28116, 34344, 99017, 59531, 53966, 14614, 80239, 54115, 4282, 92666, 85800, 68158, 19923, 65301, 28819, 42064, 24798, 20929, 44510, 73803, 10681, 11316, 3937, 14994, 89261, 5113, 19187, 3415, 10150}, {78419, 61687, 71501, 6031, 67056, 12301, 8580, 29136, 29455, 68640, 31139, 60039, 12896, 36920, 14922, 23919, 83811, 61294, 786, 26934, 37680, 63798, 89317, 47264, 2611, 92364, 5588, 32081, 48463, 78932, 39441, 44184, 18111, 41724}, {89038, 58904, 70710, 28265, 42879, 53858, 13899, 62680, 97604, 66386, 76637, 46874, 13110, 74118, 29859, 30806, 14236, 65964, 21615, 79685, 58273, 68909, 71025, 41774, 57584, 32288, 56600, 7719, 6046, 3720, 99485, 34649, 46618, 79681}})) +
                " = [3495660, 3383930, 3378048]");
        System.out.println(Arrays.toString(getBiggestThree_rev2(new int[][]{{40491, 21743, 69338, 78086, 63528, 87349, 13584, 80870, 26220, 78462, 46644, 24163, 88244, 22781, 49564, 95979, 1728, 26243, 45097, 71815, 13862, 48706, 70335, 38018, 56363, 5975, 54520, 57594, 45682, 81805, 1433, 46494, 88093, 7334, 75835, 86420, 14143, 73064, 4188, 46466, 54827, 51504, 14926, 73299, 96440}, {35576, 67019, 96918, 84956, 10459, 12411, 84853, 45654, 23573, 86967, 4519, 41913, 9132, 7551, 8831, 54543, 34646, 61133, 88497, 13728, 81860, 92597, 80131, 52687, 94386, 58656, 87750, 76734, 71300, 1708, 41707, 84361, 35000, 47666, 97134, 73096, 65527, 51960, 62315, 50046, 92726, 59527, 24760, 66115, 5255}, {68195, 58239, 39029, 81954, 58622, 53582, 64116, 27448, 82071, 78745, 64779, 44095, 53078, 80045, 81475, 57586, 76681, 73191, 538, 92492, 61902, 92554, 52488, 58462, 22321, 69909, 77690, 92824, 84135, 99301, 73590, 45120, 2699, 55464, 96789, 51418, 80074, 2759, 33220, 32942, 38996, 57129, 79363, 97891, 36312}, {3125, 79216, 24458, 34671, 30603, 75564, 55386, 81443, 44438, 82550, 95892, 99537, 85509, 20089, 86430, 27811, 54535, 71064, 74031, 51463, 76021, 99220, 46734, 13152, 33719, 34218, 52041, 79150, 68360, 18393, 21782, 50996, 69081, 95524, 42728, 18435, 96530, 11203, 18371, 56821, 74892, 65963, 292, 12474, 80038}, {86264, 30713, 56708, 27011, 11594, 24030, 30538, 99715, 79073, 94322, 17739, 55675, 97638, 52076, 67210, 29639, 36394, 12742, 42308, 36869, 39864, 45908, 55378, 89610, 5848, 38122, 34607, 55270, 49849, 86425, 45025, 71278, 74872, 73009, 81527, 3714, 25489, 75412, 98993, 79224, 65801, 18116, 12116, 21420, 59933}, {4361, 20279, 76433, 9922, 70791, 41088, 70486, 73809, 8132, 83561, 39181, 97947, 37941, 85297, 11490, 29533, 4315, 53034, 80195, 99057, 94709, 14597, 72779, 37228, 37005, 20247, 59205, 59563, 84728, 27215, 24536, 85111, 88938, 27359, 10689, 39889, 56023, 13687, 99520, 63842, 85973, 70754, 63923, 44406, 61584}, {5661, 74219, 65545, 38533, 88545, 63512, 31337, 52435, 93441, 70680, 82777, 72186, 96102, 81938, 36871, 80959, 69801, 80987, 20178, 81724, 23182, 68891, 88887, 26061, 48690, 17648, 11251, 20689, 2195, 53679, 97684, 97063, 51603, 30029, 32547, 8180, 88362, 49255, 2919, 20263, 69290, 95743, 62220, 50442, 19859}, {6907, 68140, 62674, 90272, 54540, 24170, 31479, 55831, 39699, 34589, 44303, 25628, 648, 99954, 86833, 23517, 41323, 67535, 86668, 89767, 5662, 81219, 48080, 19305, 50828, 2366, 30946, 1739, 59572, 69585, 13140, 42586, 75493, 46684, 89700, 30743, 44999, 26284, 47262, 82285, 54604, 94574, 26811, 64430, 70967}, {66249, 18235, 57289, 30368, 14832, 89818, 58070, 11253, 87399, 86080, 19652, 29068, 15516, 79294, 48598, 30580, 82873, 45121, 8531, 52763, 87418, 50292, 61188, 93391, 31681, 2850, 30270, 97136, 46961, 21509, 93741, 47964, 39668, 92827, 82287, 95672, 17705, 48857, 29400, 78390, 79699, 65710, 28195, 5377, 9914}, {42597, 49126, 65669, 98491, 32215, 1909, 64094, 18571, 36245, 98887, 7247, 10253, 87913, 25498, 90222, 64044, 15331, 61207, 40515, 46592, 6189, 4641, 2228, 35259, 95, 52283, 79379, 51213, 56843, 64918, 77123, 57491, 82267, 16140, 64921, 21289, 39460, 74565, 75175, 24092, 69121, 70769, 99664, 46516, 52116}, {57178, 41884, 36329, 55016, 22609, 84057, 25262, 44472, 38804, 48125, 83602, 53344, 30138, 27694, 5365, 65411, 82840, 23196, 84582, 36681, 76749, 95981, 97206, 98831, 18701, 57264, 2111, 55828, 51789, 22503, 20646, 12, 89311, 35058, 93305, 35340, 99971, 19035, 22830, 79106, 75808, 36853, 94095, 6209, 59564}, {26247, 69478, 21553, 49292, 26846, 18035, 65597, 12878, 54821, 35732, 60973, 71281, 94578, 40676, 39631, 89857, 23604, 2004, 22139, 85017, 30635, 40945, 99872, 92067, 66893, 72420, 22589, 91655, 15017, 7494, 49923, 65330, 7056, 16181, 45912, 26817, 3654, 65139, 45428, 4190, 68174, 47117, 1778, 98908, 12104}, {68716, 27185, 96113, 26174, 19754, 64506, 92301, 248, 10559, 77861, 64853, 6573, 62458, 7973, 64395, 90911, 18357, 1253, 71509, 91917, 68050, 72834, 42262, 17340, 99551, 60449, 75335, 41009, 67611, 44150, 69526, 28095, 63, 81782, 33132, 27027, 69265, 4132, 10655, 68422, 50800, 74408, 80520, 88777, 3681}, {6009, 87774, 87408, 32301, 29931, 94685, 43865, 63724, 78308, 93193, 2722, 80768, 62862, 72726, 45513, 97225, 61957, 60282, 31788, 94095, 38063, 16950, 83675, 72107, 78501, 16719, 27400, 13754, 88278, 54508, 48259, 89776, 217, 65375, 87489, 7876, 40253, 56231, 60604, 40436, 68951, 72718, 51035, 5631, 16970}, {68356, 3388, 86, 2465, 84912, 33058, 6953, 43173, 32035, 41609, 8272, 80932, 82702, 86155, 49007, 59988, 57754, 11101, 62530, 10794, 79841, 8102, 50306, 13171, 31394, 75734, 35939, 87910, 7171, 62245, 97315, 98949, 69772, 36394, 66411, 36515, 10621, 10111, 26292, 3574, 71153, 84176, 2521, 8153, 93067}, {14117, 9505, 64900, 91858, 11070, 57278, 58256, 10182, 90685, 24451, 83756, 15318, 25621, 15779, 24925, 3410, 60554, 33046, 73253, 66475, 88541, 98933, 32906, 21093, 80743, 29407, 6778, 84967, 34711, 71653, 48831, 18167, 23804, 76545, 42213, 21679, 17301, 79490, 97173, 98242, 82811, 23743, 32707, 27372, 97596}, {79389, 27530, 6754, 9485, 49237, 60059, 87291, 74076, 60586, 98695, 609, 44755, 76152, 54682, 21249, 82561, 38468, 46980, 92099, 35964, 17685, 26496, 23735, 11880, 9866, 41232, 88604, 64976, 71112, 14984, 17021, 78602, 78240, 16032, 56917, 69380, 31114, 93960, 53387, 28507, 60677, 26308, 67759, 62173, 65590}, {74196, 47469, 4089, 68042, 75210, 60861, 30270, 60145, 41443, 65944, 11041, 59709, 24839, 99552, 44759, 22548, 36018, 8297, 31805, 61148, 13036, 12618, 76145, 60010, 46313, 88161, 12815, 42856, 74479, 28434, 98442, 79319, 35641, 28217, 74407, 92461, 23174, 24010, 28275, 42793, 27644, 95328, 57651, 57013, 71104}, {98563, 15164, 45710, 99498, 19757, 95443, 3766, 63063, 56835, 14171, 68156, 57917, 63334, 89611, 4682, 65654, 17456, 61359, 97493, 24984, 35613, 77835, 56179, 70265, 88952, 36085, 89337, 70763, 47004, 5970, 11182, 29285, 25198, 16793, 91522, 24452, 17954, 95472, 16055, 88759, 66721, 97150, 90858, 91991, 55418}, {24849, 98455, 26381, 8009, 2755, 78498, 19056, 44011, 72988, 8198, 56340, 92176, 69849, 71421, 70478, 70647, 13472, 5831, 43992, 54406, 7209, 79965, 33989, 30275, 56687, 70848, 1954, 24525, 92637, 54706, 17791, 42622, 96599, 47363, 21316, 86081, 95521, 31973, 27913, 20569, 16336, 1732, 82473, 69128, 16243}, {24433, 29166, 88525, 99756, 62893, 20754, 71955, 24467, 83320, 59310, 62920, 70725, 56635, 93877, 38935, 6910, 40285, 78295, 90378, 33757, 50924, 22630, 79980, 39244, 73496, 77806, 35440, 85567, 4844, 91237, 2539, 55016, 90118, 89724, 54213, 77173, 59086, 43465, 18073, 10899, 63786, 95539, 28757, 33142, 67791}, {47463, 63854, 95970, 4279, 97683, 49776, 48990, 24221, 74269, 10239, 77919, 46824, 91171, 17033, 29105, 43741, 82904, 75036, 26348, 31125, 95216, 68038, 33014, 39926, 79723, 45477, 4310, 37680, 66752, 27848, 88818, 55363, 54444, 59991, 885, 39361, 71347, 66217, 8454, 35102, 76270, 25506, 87848, 63211, 94505}, {22229, 94776, 14418, 56023, 39555, 92621, 72743, 8607, 6318, 90223, 60032, 77615, 60675, 52155, 78553, 30644, 75925, 95384, 38832, 24154, 10545, 73317, 62691, 59384, 98137, 70512, 56566, 74322, 44260, 4577, 39469, 50724, 13821, 89722, 27586, 88954, 72126, 4013, 88849, 13258, 83057, 47165, 65617, 86217, 26911}, {11258, 58391, 23369, 40666, 5593, 43980, 27452, 70421, 10526, 30519, 18950, 96759, 41871, 72721, 377, 73221, 65910, 65554, 64295, 14923, 74312, 77627, 15292, 58289, 85423, 60864, 97643, 68836, 40902, 74197, 92050, 87992, 86527, 59775, 40192, 27069, 89482, 12000, 97663, 77879, 96918, 63426, 16059, 58690, 56425}, {90810, 47429, 60514, 43636, 72279, 4627, 82628, 5499, 83280, 33210, 89619, 32813, 33196, 49547, 22403, 59683, 30965, 98029, 49934, 81867, 58964, 58479, 2483, 51723, 61960, 98201, 34295, 45835, 8105, 67962, 89152, 51630, 69334, 50564, 74777, 45826, 28912, 65963, 15171, 70711, 8496, 55972, 19833, 9648, 94378}, {83428, 69112, 59112, 45405, 70608, 88615, 20460, 98613, 88660, 26684, 94855, 36760, 4565, 40759, 8161, 48988, 82145, 56644, 60434, 39664, 12810, 97300, 27189, 61011, 21762, 66457, 55182, 17102, 93836, 49978, 65868, 21225, 3452, 56782, 28691, 83540, 58994, 19762, 38996, 91286, 13871, 47129, 15491, 51512, 7659}, {695, 51225, 54612, 81859, 25670, 52092, 41512, 50638, 13598, 56030, 33956, 51227, 73191, 73570, 84179, 83918, 45986, 75951, 27664, 86091, 64147, 51178, 73860, 27632, 35712, 62954, 4048, 18956, 87813, 67093, 17863, 19792, 549, 8644, 92303, 68724, 28985, 72158, 26352, 51372, 6654, 29557, 26264, 71087, 53158}}
        )) + " = [2955471,2900947,2888411]");
    }

    public static int[] getBiggestThree_rev2(int[][] grid) {
        TreeSet<Long> sums = new TreeSet<>();
        int rows = grid.length, cols = rows > 0 ? grid[0].length : 0;
        int maxSide = 1 + Math.min(rows, cols) / 2;
        for (int row = 0; row < rows; row++) {
            nextCol:
            for (int col = 0; col < cols; col++) {
                add(sums, grid[row][col]);
//                Assume that [row,col] is teh top point of the rhombus, keep expanding to the left and right from top and bottom.
                for (int k = 1; k <= maxSide; k++) {
                    if (row + 2 * k >= rows || col - k < 0 || col + k >= cols) continue nextCol;
                    int sum = 0;
                    int r = row, c = col;
                    for (int l = 0; l < k; l++) sum += grid[r++][c--];   // Collect the top left side of the rhombus.
                    for (int l = 0; l < k; l++) sum += grid[r++][c++];  // Collect the bottom left side of the rhombus.
                    for (int l = 0; l < k; l++) sum += grid[r--][c++];  // Collect the bottom right side of the rhombus.
                    for (int l = 0; l < k; l++) sum += grid[r--][c--];  // Collect the top right side of the rhombus.
                    add(sums, sum);
                }
            }
        }
        return buildResult(sums);
    }

    private static int[] buildResult(TreeSet<Long> sums) {
        int size = Math.min(sums.size(), 3), i = 0;
        int[] result = new int[size];
        while (i < size) {
            long poll = sums.pollLast();
            sums.remove(poll);
            result[i++] = (int) poll;
        }
        return result;
    }

    private static void add(TreeSet<Long> sums, long val) {
        sums.add(val);
        if (sums.size() > 3) sums.remove(sums.pollFirst());
    }

    public static int[] getBiggestThree(int[][] grid) {
        TreeSet<Long> sums = new TreeSet<>();
        int rows = grid.length, cols = rows > 0 ? grid[0].length : 0;
        Map<String, Rhombus> dp = new HashMap<>();
//        Build DP.
        for (int row = 0; row < rows; row++) {
            for (int col = 0; col < cols; col++) {
                String key = getKey(row, col);
                Rhombus rhombus = new Rhombus(row, col, grid[row][col]);
                dp.put(key, rhombus);
                expand(grid, row, col, rows, cols, rhombus);
            }
        }
        int maxSize = getMaxSize(rows, cols);
        for (int row = 0; row < rows; row++) {
            nextRow:
            for (int col = 0; col < cols; col++) {
//                Assume [row, col] as center and get the sums starting from rhombus length 1 to max.
                sums.add((long) grid[row][col]);
                for (int k = 1; k <= maxSize; k++) {
                    Rhombus top = dp.get(getKey(row - k, col)), bottom = dp.get(getKey(row + k, col));
                    Rhombus left = dp.get(getKey(row, col - k)), right = dp.get(getKey(row, col + k));
                    if (top == null || bottom == null || left == null || right == null) continue nextRow;
                    long topLeft = top.getLeft(k), topRight = top.getRight(k);
                    long bottomLeft = left.getRight(k), bottomRight = right.getLeft(k);
                    if (topLeft == -1 || topRight == -1 || bottomLeft == -1 || bottomRight == -1) continue nextRow;
                    long sum = k == 0 ? topLeft : topLeft + topRight + bottomLeft + bottomRight - top.val - left.val - right.val - bottom.val;
                    sums.add(sum);
                    if (sums.size() > 3) sums.remove(sums.pollFirst());
                }
            }
        }
        int size = Math.min(sums.size(), 3), i = 0;
        int[] result = new int[size];
        while (i < size) {
            long poll = sums.pollLast();
            sums.remove(poll);
            result[i++] = (int) poll;
        }
        return result;
    }

    private static int getMaxSize(int rows, int cols) {
        int maxSize = Math.min(rows, cols);
        maxSize /= 2;
        maxSize++;
        return maxSize;
    }

    private static String getKey(int row, int col) {
        return String.format("[%d,%d]", row, col);
    }

    private static void expand(int[][] grid, int row, int col, int rows, int cols, Rhombus rhombus) {
        int leftCol = col, rightCol = col;
        int startRow = row;
        while (row < rows && leftCol >= 0) {
            rhombus.addLeft(grid[row][leftCol--]);
            row++;
        }
        row = startRow;
        while (row < rows && rightCol < cols) {
            rhombus.addRight(grid[row][rightCol++]);
            row++;
        }
    }

    static class Rhombus {
        int row, cols, val;
        long lPre = 0, rPre = 0;
        List<Long> lefts = new ArrayList<>();
        List<Long> rights = new ArrayList<>();

        public Rhombus(int row, int cols, int val) {
            this.row = row;
            this.cols = cols;
            this.val = val;
        }

        public void addLeft(long val) {
            lefts.add(lPre += val);
        }

        public long getLeft(int len) {
            return len >= lefts.size() ? -1 : lefts.get(len);
        }

        public void addRight(long val) {
            rights.add(rPre += val);
        }

        public long getRight(int len) {
            return len >= rights.size() ? -1 : rights.get(len);
        }

        @Override
        public String toString() {
            return "Rhombus{" +
                    "row=" + row +
                    ", cols=" + cols +
                    ", lefts=" + lefts +
                    ", rights=" + rights +
                    '}';
        }
    }
}
