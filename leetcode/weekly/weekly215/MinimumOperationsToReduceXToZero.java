package weekly.weekly215;

import java.util.*;

/**
 * Created on:  Nov 14, 2020
 * Questions:
 */

public class MinimumOperationsToReduceXToZero {

    static int min;

    public static void main(String[] args) {
        System.out.println("********************************************* Solution 1 ********************************************");
        System.out.println(minOperations(new int[]{1, 1, 4, 2, 3}, 5));
        System.out.println(minOperations(new int[]{8828, 9581, 49, 9818, 9974, 9869, 9991, 10000, 10000, 10000, 9999, 9993, 9904, 8819, 1231, 6309}, 134365));
        System.out.println(minOperations(new int[]{5366, 6197, 4837, 2228, 2306, 3612, 3045, 2795, 3815, 1958, 3620, 4791, 2208, 460, 28, 2155, 9401, 2973, 6075, 8909, 3546, 42, 367, 2115, 3660, 4112, 6409, 5493, 9336, 7725, 6207, 6197, 8301, 6633, 3396, 7707, 1788, 6472, 7635, 1701, 1774, 8732, 7528, 2337, 387, 5951, 377, 6643, 5432, 7427, 8793, 1918, 973, 6742, 4826, 4046, 1608, 3627, 6695, 4054, 2930, 4697, 4988, 1713, 7807, 2302, 5495, 9187, 9088, 5121, 9051, 2236, 6001, 3344, 8962, 8587, 1432, 8400, 9819, 6340, 2650, 2823, 6787, 873, 8253, 9404, 3035, 8498, 8061, 5269, 3599, 9748, 7682, 4108, 3482, 9848, 8926, 2451, 7570, 9110, 6416, 7939, 19, 5082, 4586, 895, 428, 2968, 6882, 9817, 5053, 9259, 6433, 2834, 6246, 9374, 7178, 5183, 2954, 694, 5765, 2363, 6568, 6587, 2024, 7624, 8806, 680, 4513, 2993, 2291, 7298, 6048, 8631, 3730, 9380, 4493, 1199, 8309, 6313, 1069, 8219, 7554, 77, 2005, 1367, 674, 2392, 6964, 1484, 3328, 6512, 6696, 9116, 3439, 9516, 991, 6881, 2770, 1138, 2677, 8047, 5067, 2672, 3264, 8310, 269, 2206, 6320, 1996, 3884, 1051, 6879, 4808, 3685, 4466, 10, 8080, 4987, 3387, 7092, 1690, 7018, 4230, 1204, 4626, 2439, 6948, 719, 3110, 8429, 4806, 5927, 9997, 1428, 8307, 5677, 629, 6326, 2625, 2142, 5536, 603, 1630, 2690, 6983, 1066, 1187, 4107, 5677, 8143, 1683, 9315, 2500, 2467, 3555, 4175, 9802, 184, 7850, 47, 6701, 8566, 2147, 13, 9880, 6424, 1753, 1173, 9551, 3691, 4254, 9356, 2543, 6308, 7926, 8507, 3518, 4736, 5548, 9220, 4949, 6868, 488, 4091, 9503, 2691, 6521, 8292, 2567, 6586, 2806, 8070, 736, 1589, 8557, 8132, 9661, 7629, 378, 2035, 4677, 1868, 2737, 3453, 4448, 1702, 2592, 5733, 7517, 3432, 729, 3443, 1736, 9239, 9588, 4751, 7263, 8824, 7204, 7373, 4010, 7022, 4048, 4611, 8824, 4302, 327, 5359, 6293, 4176, 7618, 5030, 3593, 6838, 3224, 7979, 7473, 5567, 9985, 8678, 7809, 4438, 9500, 4621, 3455, 8365, 9313, 1227, 3484, 1407, 7502, 1600, 9564, 6176, 7921, 2070, 4481, 1431, 9742, 2038, 410, 1700, 1531, 1248, 4290, 1912, 7089, 2729, 6780, 916, 1258, 5366, 8667, 4695, 2969, 8397, 6333, 3543, 1965, 7545, 4133, 6316, 4722, 286, 8775, 1674, 9940, 5643, 3115, 4642, 6778, 3092, 742, 5701, 594, 5712, 1950, 3346, 7846, 3673, 4850, 5325, 2350, 6873, 6510, 856, 5884, 8925, 373, 3598, 9197, 138, 6045, 1777, 4143, 9875, 3053, 1760, 3710, 7928, 9338, 4328, 9870, 6125, 5128, 296, 6615, 650, 4198, 9990, 6743, 9625, 7691, 9398, 7957, 295, 5811, 5078, 2654, 7571, 5555, 6594, 8820, 7252, 9601, 1743, 7968, 4265, 9592, 9224, 514, 3061, 5824, 7464, 341, 7111, 4801, 9413, 8031, 1347, 8044, 8382, 6183, 662, 4827, 3641, 3058, 7080, 230, 627, 389, 6571, 6606, 4961, 4771, 9535, 7614, 9273, 6246, 296, 3714, 2411, 833, 9329, 4749, 973, 9559, 8692, 8147, 1578, 4080, 7577, 2088, 955, 8817, 6136, 1346, 9166, 939, 1317, 9167, 6367, 3743, 671, 2798, 87, 6463, 9319, 8122, 8234, 8155, 9649, 3370, 5192, 4725, 7082, 5057, 4207, 4205, 121, 5922, 1299, 6831, 6761, 2972, 6369, 4196, 5859, 1372, 4855, 7958, 1465, 9793, 642, 9926, 9244, 4021, 8332, 3131, 942, 5148, 7361, 9853, 5327, 9119, 5349, 5641, 2676, 3371, 1911, 1707, 8139, 7667, 6509, 1984, 4310, 8855, 7501, 1656, 3642, 6415, 5369, 1297, 4682, 9972, 889, 3005, 6487, 1877, 8414, 5047, 1385, 5708, 1336, 1775, 9888, 8049, 4189, 7019, 6207, 8142, 547, 829, 3021, 8443, 1457, 3128, 9274, 4680, 8938, 3979, 6728, 6409, 6548, 766, 3388, 3310, 7029, 3127, 6460, 4528, 7536, 8668, 6245, 5824, 9265, 3519, 8901, 1782, 4754, 2828, 7040, 4614, 7956, 9025, 5067, 3010, 3200, 4226, 8994, 8664, 1222, 7044, 4587, 7653, 7815, 8013, 897, 6425, 2023, 5387, 5306, 8531, 1228, 634, 2846, 5603, 235, 567, 2399, 2555, 3511, 4888, 2454, 7316, 7231, 5084, 6756, 7356, 54, 4919, 4414, 8957, 4922, 5299, 1106, 9475, 7772, 534, 9713, 459, 7935, 3740, 7057, 4908, 9433, 5701, 331, 1245, 2803, 2647, 5900, 5705, 543, 2937, 302, 8309, 5949, 318, 557, 2310, 873, 3473, 2702, 6380, 2203, 8503, 5494, 9518, 3972, 5832, 1644, 9203, 7361, 140, 2104, 915, 8526, 7917, 4211, 1612, 1243, 2973, 9094, 5724, 8540, 8659, 2368, 8055, 4914, 9570, 4989, 1170, 7987, 3081, 4424, 4243, 6588, 8035, 2210, 9216, 464, 7975, 2516, 7911, 6626, 5458, 4431, 6489, 9224, 9231, 2294, 3093, 1011, 5005, 8077, 2910, 6143, 5498, 5961, 8618, 6027, 1975, 4359, 6569, 3518, 5757, 169, 750, 4941, 9262, 1000, 2069, 2805, 8329, 2051, 2461, 5173, 2057, 9001, 8772, 9004, 1426, 9105, 8441, 5253, 9710, 3061, 8151, 7012, 5808, 180, 255, 3590, 1125, 5111, 978, 4574, 2525, 8735, 1500, 3830, 3337, 5736, 3967, 5253, 1282, 2140, 519, 9601, 975, 9779, 378, 8426, 2810, 5550, 3859, 4767, 5893, 675, 7279, 35, 678, 3721, 2173, 796, 1571, 169, 2423, 9808, 8003, 791, 7409, 589, 4411, 6512, 8501, 7476, 8729, 7857, 2601, 5403, 7794, 8972, 6128, 4957, 7801, 4075, 6577, 2172, 9187, 4009, 9925, 8681, 9514, 7072, 3251, 6963, 8107, 1099, 298, 2520, 3164, 2507, 1448, 4586, 2391, 6126, 7144, 4572, 7906, 6545, 3181, 1729, 7616, 3429, 3765, 8218, 7225, 671, 7471, 2859, 5810, 4657, 1645, 9568, 8580, 3316, 9907, 8569, 5424, 6316, 1541, 1622, 318, 455, 996, 7066, 143, 3422, 5732, 2739, 3862, 9923, 8626, 7814, 2831, 8775, 1674, 1689, 1845, 7189, 8848, 2775, 1847}, 823688619));
        System.out.println(minOperations(new int[]{9677, 8800, 4181, 5725, 1936, 9989, 2950, 630, 1045, 7471, 2853, 7557, 8279, 6189, 9110, 9274, 8161, 7216, 2159, 3993, 9991, 8992, 2084, 687, 3221, 8675, 7167, 4373, 5326, 9977, 6615, 3065, 7575, 738, 4000, 1196, 8303, 2697, 7901, 3171, 6265, 200, 2865, 8786, 5419, 2821, 3081, 6327, 323, 2652, 8971, 8031, 3417, 2539, 9080, 4831, 1513, 5067, 5835, 482, 3231, 3656, 1361, 2769, 5570, 9832, 4527, 9890, 4992, 8613, 782, 3051, 6766, 7709, 6759, 9646, 4724, 8025, 8508, 4680, 4691, 1248, 4386, 5971, 3717, 425, 6066, 1091, 879, 53, 6055, 9781, 3322, 1652, 2902, 8153, 4144, 2293, 4023, 4430, 2168, 1072, 4182, 3709, 4786, 9650, 4981, 2762, 286, 8234, 802, 589, 9838, 8027, 7884, 4949, 3943, 4040, 4521, 2327, 5338, 3374, 2276, 3209, 450, 203, 125, 9525, 2313, 4142, 9250, 2628, 7640, 6889, 9111, 8824, 9326, 4855, 1744, 2239, 5299, 6531, 3164, 1170, 5451, 9647, 8820, 8025, 9091, 841, 9462, 1175, 4305, 781, 8791, 723, 6374, 6865, 2750, 8843, 3529, 3716, 1030, 7768, 1552, 9145, 3323, 7587, 6872, 1308, 4035, 6559, 2822, 4133, 7847, 2132, 9227, 7808, 1541, 5222, 8864, 8152, 5547, 5743, 4143, 4297, 9461, 3681, 7625, 6170, 9964, 9438, 6290, 3609, 8987, 5463, 720, 915, 4891, 5239, 7030, 5074, 3369, 9764, 5098, 9750, 1934, 4674, 9791, 8423, 1548, 5092, 4497, 1425, 4367, 4852, 3791, 2823, 3368, 5978, 6958, 4132, 5580, 4516, 7184, 1601, 4752, 9249, 2666, 3034, 1941, 6044, 1162, 4615, 7343, 3683, 1475, 5945, 4172, 5785, 1582, 4703, 1986, 9101, 4353, 9243, 8530, 8433, 2937, 4160, 7913, 2032, 1949, 5473, 8309, 5610, 8102, 2773, 730, 4829, 6658, 2919, 6920, 648, 8631, 4456, 7870, 335, 3775, 6930, 9846, 3590, 5701, 3206, 3027, 5536, 3797, 8618, 6995, 9051, 2991, 2020, 8032, 9765, 7507, 5396, 7056, 911, 9526, 3706, 7037, 3607, 821, 1080, 137, 9150, 5426, 9452, 4999, 152, 1582, 7533, 155, 7711, 6266, 1483, 3391, 298, 7632, 7866, 2292, 5370, 7830, 5393, 861, 8244, 8317, 1386, 4087, 1724, 2064, 287, 236, 6413, 1107, 3916, 9210, 5551, 1215, 4716, 2700, 7655, 8248, 5326, 2190, 7768, 2162, 8147, 6777, 9500, 7404, 8477, 5124, 5365, 7656, 6205, 4141, 2325, 2323, 8941, 2362, 877, 1238, 2511, 8066, 3925, 3346, 6199, 2297, 6354, 3744, 2550, 4880, 1316, 1221, 7154, 5901, 6523, 6569, 1538, 7452, 6762, 2091, 1032, 8186, 6566, 3896, 1461, 3465, 7504, 3872, 7438, 7889, 2143, 6878, 5959, 5409, 7209, 7293, 169, 1738, 2322, 2022, 2033, 3482, 1326, 8896, 7949, 8556, 6995, 6806, 7858, 7885, 7422, 97, 2988, 9728, 5824, 7340, 5919, 1112, 4695, 774, 4530, 9651, 8986, 3937, 2908, 7192, 1909, 5915, 2738, 3378, 9484, 3873, 5894, 6579, 6734, 9749, 4699, 4184, 4979, 5346, 3789, 258, 5322, 646, 5572, 104, 9206, 6917, 5813, 1652, 7135, 4077, 2669, 5888, 647, 2710, 5589, 2427, 4886, 1793, 8248, 5746, 3353, 8671, 457, 6831, 6894, 1317, 7538, 1679, 1, 6557, 3307, 2755, 4531, 573, 8981, 9834, 2013, 4547, 9935, 6564, 8135, 3282, 3870, 4645, 8343, 3989, 883, 4826, 8314, 5792, 1108, 9723, 7820, 8030, 8701, 6533, 3847, 775, 3901, 8321, 8864, 2396, 7367, 9010, 1967, 4651, 373, 6715, 4699, 6128, 891, 4357, 2248, 7661, 5428, 7353, 9164, 2935, 3547, 7872, 1329, 1720, 1448, 4976, 8777, 4038, 1627, 4421, 2495, 8644, 3769, 2323, 7254, 7290, 6304, 1263, 5080, 130, 5866, 9920, 5776, 8547, 3995, 3576, 6480, 8522, 4854, 4516, 9532, 3667, 7794, 6163, 3489, 3639, 9856, 6598, 1211, 2015, 8485, 1171, 4644, 6312, 230, 2146, 5910, 3305, 7412, 8450, 2756, 5384, 9323, 3771, 7307, 5595, 8401, 4987, 6524, 782, 9804, 5416, 9426, 1843, 1369, 3399, 782, 5933, 3125, 935, 4117, 803, 5476, 9063, 8892, 9227, 8265, 5631, 6652, 9329, 3760, 7617, 9971, 2368, 8664, 944, 7062, 5024, 3819, 1653, 6457, 5877, 9783, 6007, 787, 5451, 2068, 514, 453, 4787, 7669, 1768, 6816, 1075, 6104, 7034, 41, 8063, 1474, 2972, 875, 6169, 7429, 574, 2553, 334, 41, 5063, 3484, 3468, 4277, 5413, 9639, 2515, 9082, 3862, 2671, 6142, 4564, 6621, 376, 6818, 7803, 813, 8327, 2617, 4240, 5514, 1397, 7102, 2794, 4246, 209, 8322, 1889, 1205, 4495, 4795, 453, 1196, 6004, 8215, 7984, 5445, 3689, 6363, 9171, 3839, 1483, 2763, 6236, 9020, 9415, 4218, 1410, 862, 1052, 937, 174, 3338, 5060, 4657, 285, 1940, 5842, 9250, 3946, 8743, 7033, 4400, 54, 4227, 6681, 7852, 2379, 7849, 3537, 872, 4982, 2552, 330, 4382, 710, 2868, 5613, 4680, 9845, 8185, 6174, 2763, 9109, 3785, 5369, 8066, 2205, 8465, 7477, 8312, 2341, 3436, 7344, 5561, 4876, 4846, 8331, 4955, 6530, 5389, 5077, 9866, 502, 4034, 5408, 5243, 3137, 6684, 8011, 2451, 1909, 8231, 9157, 2476, 3495, 5910, 2790, 6873, 5238, 1251, 6975, 9844, 1577, 4571, 4595, 2156, 3877, 7085, 2514, 5380, 2778, 224, 515, 8004, 679, 46, 6414, 8424, 2333, 6107, 5241, 1589, 3213, 2639, 1937, 7448, 2832, 3940, 5114, 60, 4326, 5463, 8262, 5550, 5403, 2611, 158, 864, 7078, 6935, 106, 8983, 1234, 895, 4826, 6786, 7988, 6373, 7130, 1605, 7330, 1605, 6421, 9052, 6394, 9744, 5774, 2691, 7854, 4188, 3877, 3864, 7001, 9853, 300, 1933, 8902, 4483, 8880, 9582, 9599, 9407, 8205, 4645, 8166, 6603, 633, 5860, 9706, 1830, 9675, 1816, 956, 8186, 8966, 195, 2578, 2833, 2309, 7955, 5696, 9163, 2713, 8249, 2553, 6753, 166, 2775, 1995, 2438, 8906, 9072, 2113, 3634, 7218, 192, 425, 2270, 1144, 3617, 408, 6325, 4839, 4955, 5000, 6171, 6162, 5307, 6745, 4693, 5006, 7493, 5823, 2865, 8526, 2208, 4796, 9264, 8171, 2853, 8771, 6707, 9295, 1099, 2602, 9207, 7623, 3611, 2408, 5133, 9386, 9739, 3277, 9910, 9284, 5611, 5110, 9540, 6610, 6124, 5483, 8782, 9406, 2323, 3239, 8654, 4930, 776, 6818, 8899, 4973, 4455, 5231, 4642, 1838, 7280}, 284132523));
        System.out.println(minOperations(new int[]{6388, 817, 7938, 1058, 2185, 2516, 1766, 7448, 9210, 8391, 7301, 2645, 5698, 5312, 6697, 1662, 3604, 8384, 4316, 5195, 17, 7694, 9640, 1283, 3223, 3192, 6098, 8679, 9475, 6881, 697, 4252, 9214, 1299, 5856, 3408, 869, 8525, 8048, 3857, 8264, 1559, 6062, 6118, 2478, 5579, 1151, 9879, 7497, 5882, 345, 5084, 1740, 4015, 9456, 5632, 6494, 3458, 8770, 337, 9620, 4555, 7095, 8837, 6090, 2380, 4410, 4240, 5108, 246, 1811, 1325, 7759, 2842, 2328, 3335, 4990, 7853, 4991, 5001, 5388, 720, 4020, 3911, 2318, 9782, 5051, 276, 5918, 6225, 9965, 4996, 9069, 9021, 3330, 5657, 2430, 8417, 4815, 3699, 6162, 8619, 225, 8857, 4179, 3171, 2417, 5327, 6583, 6393, 2192, 9394, 9502, 2267, 9721, 5289, 2866, 6994, 7548, 2804, 4931, 2673, 6219, 6009, 6436, 9153, 9820, 5649, 2970, 1983, 6295, 2984, 5850, 5003, 9219, 4290, 1278, 8920, 2233, 6738, 7324, 5779, 4152, 6820, 4169, 9431, 1451, 3141, 1139, 1950, 4627, 7454, 6966, 9541, 7620, 8000, 6701, 4376, 9713, 4152, 1693, 1811, 7798, 7266, 286, 5268, 5606, 234, 9982, 1901, 8143, 5835, 2079, 8681, 6937, 3667, 8001, 1541, 9459, 586, 8211, 3300, 9639, 1286, 7033, 6802, 9096, 9130, 1751, 8377, 4132, 8281, 1425, 9541, 5501, 9504, 6257, 37, 7916, 6419, 8483, 9324, 7026, 3967, 2226, 3807, 3507, 378, 5042, 8304, 9972, 4030, 1730, 5790, 3897, 7435, 1878, 4393, 2236, 8704, 6315, 6057, 395, 2138, 5319, 6806, 5216, 2816, 1633, 1462, 5796, 8334, 1240, 7269, 9756, 3439, 7404, 9542, 7113, 9015, 3547, 596, 105, 7141, 7146, 2757, 4413, 9752, 794, 9803, 566, 6703, 6857, 5320, 272, 3917, 8823, 3975, 9395, 3412, 4554, 7838, 7651, 2943, 5446, 4170, 3025, 4529, 5996, 7956, 6571, 2794, 1438, 18, 2906, 7485, 8172, 5459, 1536, 1719, 1759, 33, 3329, 3645, 4409, 4265, 4784, 4044, 964, 705, 9110, 4417, 5766, 9243, 1545, 5877, 684, 6329, 1507, 5267, 5238, 3789, 7601, 4596, 206, 4080, 2132, 2213, 1906, 2017, 407, 575, 5223, 9646, 3296, 4046, 4647, 9664, 985, 8646, 9696, 1581, 8009, 9790, 2857, 5494, 5824, 3215, 2958, 8569, 8253, 3131, 8513, 8098, 3085, 8662, 6661, 8735, 408, 5765, 584, 6809, 256, 9182, 7724, 5123, 5040, 1243, 3760, 5288, 1311, 6319, 4050, 7246, 9104, 5553, 7778, 7718, 5075, 1755, 8008, 4335, 3268, 4675, 701, 7867, 175, 1454, 2990, 6710, 9476, 9744, 7686, 5826, 5379, 7379, 1882, 3266, 2205, 5205, 5094, 8064, 1065, 4819, 5492, 7009, 9368, 810, 9799, 4685, 6245, 9393, 1666, 5698, 8500, 6312, 8126, 5084, 9051, 2672, 2509, 1901, 9807, 6964, 8427, 6269, 7044, 7199, 7287, 6512, 7673, 621, 4784, 9168, 4959, 7410, 4782, 2595, 8086, 5875, 7880, 9090, 3821, 8244, 7949, 1564, 9342, 6501, 4018, 5669, 2714, 8628, 3041, 2934, 1385, 3639, 5274, 1128, 6773, 2920, 5181, 1352, 2753, 6676, 5200, 7289, 4013, 6, 7124, 1538, 1695, 6802, 4701, 1190, 4628, 3145, 9246, 2168, 564, 8913, 5782, 5476, 2462, 8907, 26, 1456, 7671, 3345, 8120, 7952, 2827, 3519, 2495, 5558, 9799, 7768, 150, 6957, 1798, 9965, 5626, 334, 1914, 7003, 901, 8789, 5180, 54, 5717, 7480, 5559, 6662, 4382, 5852, 2582, 3359, 6042, 1385, 2577, 3156, 6715, 8496, 9578, 3799, 5903, 6018, 9196, 1770, 5964, 2261, 3792, 5185, 9310, 3359, 9057, 4024, 6067, 4104, 8272, 3434, 8064, 9233, 292, 1778, 8519, 2395, 4095, 3674, 7897, 5733, 1198, 8363, 6928, 1504, 4901, 5379, 9112, 4707, 9737, 5727, 2206, 7351, 8172, 9433, 3387, 1815, 9551, 482, 7100, 4680, 9329, 8116, 2684, 4394, 1554, 5680, 8041, 5560, 7697, 5566, 8716, 3283, 2555, 8401, 357, 5524, 484, 7317, 1933, 5833, 3361, 893, 814, 9042, 3330, 9145, 6817, 7949, 4822, 7666, 3828, 6571, 3109, 5226, 8234, 5013, 7873, 4749, 9180, 695, 9870, 5027, 6150, 1316, 7340, 6276, 3684, 8456, 9233, 5902, 900, 4266, 5042, 5626, 3340, 1755, 2313, 2532, 6229, 2210, 2277, 440, 2619, 8231, 7211, 9626, 5276, 8390, 6310, 3330, 4735, 3277, 7705, 2396, 1167, 4040, 2392, 3639, 9992, 9805, 5603, 7393, 5737, 14, 5769, 9720, 5651, 6942, 5949, 6598, 5835, 3392, 557, 1672, 4763, 5047, 4579, 9973, 9381, 2642, 8915, 6209, 3305, 8141, 3400, 5629, 983, 5222, 4347, 3081, 8774}, 1806040));
        System.out.println("********************************************* Solution 2 ********************************************");
        System.out.println(minOperations_dfs(new int[]{1, 1, 4, 2, 3}, 5));
        System.out.println(minOperations_dfs(new int[]{8828, 9581, 49, 9818, 9974, 9869, 9991, 10000, 10000, 10000, 9999, 9993, 9904, 8819, 1231, 6309}, 134365));
        System.out.println(minOperations_dfs(new int[]{5366, 6197, 4837, 2228, 2306, 3612, 3045, 2795, 3815, 1958, 3620, 4791, 2208, 460, 28, 2155, 9401, 2973, 6075, 8909, 3546, 42, 367, 2115, 3660, 4112, 6409, 5493, 9336, 7725, 6207, 6197, 8301, 6633, 3396, 7707, 1788, 6472, 7635, 1701, 1774, 8732, 7528, 2337, 387, 5951, 377, 6643, 5432, 7427, 8793, 1918, 973, 6742, 4826, 4046, 1608, 3627, 6695, 4054, 2930, 4697, 4988, 1713, 7807, 2302, 5495, 9187, 9088, 5121, 9051, 2236, 6001, 3344, 8962, 8587, 1432, 8400, 9819, 6340, 2650, 2823, 6787, 873, 8253, 9404, 3035, 8498, 8061, 5269, 3599, 9748, 7682, 4108, 3482, 9848, 8926, 2451, 7570, 9110, 6416, 7939, 19, 5082, 4586, 895, 428, 2968, 6882, 9817, 5053, 9259, 6433, 2834, 6246, 9374, 7178, 5183, 2954, 694, 5765, 2363, 6568, 6587, 2024, 7624, 8806, 680, 4513, 2993, 2291, 7298, 6048, 8631, 3730, 9380, 4493, 1199, 8309, 6313, 1069, 8219, 7554, 77, 2005, 1367, 674, 2392, 6964, 1484, 3328, 6512, 6696, 9116, 3439, 9516, 991, 6881, 2770, 1138, 2677, 8047, 5067, 2672, 3264, 8310, 269, 2206, 6320, 1996, 3884, 1051, 6879, 4808, 3685, 4466, 10, 8080, 4987, 3387, 7092, 1690, 7018, 4230, 1204, 4626, 2439, 6948, 719, 3110, 8429, 4806, 5927, 9997, 1428, 8307, 5677, 629, 6326, 2625, 2142, 5536, 603, 1630, 2690, 6983, 1066, 1187, 4107, 5677, 8143, 1683, 9315, 2500, 2467, 3555, 4175, 9802, 184, 7850, 47, 6701, 8566, 2147, 13, 9880, 6424, 1753, 1173, 9551, 3691, 4254, 9356, 2543, 6308, 7926, 8507, 3518, 4736, 5548, 9220, 4949, 6868, 488, 4091, 9503, 2691, 6521, 8292, 2567, 6586, 2806, 8070, 736, 1589, 8557, 8132, 9661, 7629, 378, 2035, 4677, 1868, 2737, 3453, 4448, 1702, 2592, 5733, 7517, 3432, 729, 3443, 1736, 9239, 9588, 4751, 7263, 8824, 7204, 7373, 4010, 7022, 4048, 4611, 8824, 4302, 327, 5359, 6293, 4176, 7618, 5030, 3593, 6838, 3224, 7979, 7473, 5567, 9985, 8678, 7809, 4438, 9500, 4621, 3455, 8365, 9313, 1227, 3484, 1407, 7502, 1600, 9564, 6176, 7921, 2070, 4481, 1431, 9742, 2038, 410, 1700, 1531, 1248, 4290, 1912, 7089, 2729, 6780, 916, 1258, 5366, 8667, 4695, 2969, 8397, 6333, 3543, 1965, 7545, 4133, 6316, 4722, 286, 8775, 1674, 9940, 5643, 3115, 4642, 6778, 3092, 742, 5701, 594, 5712, 1950, 3346, 7846, 3673, 4850, 5325, 2350, 6873, 6510, 856, 5884, 8925, 373, 3598, 9197, 138, 6045, 1777, 4143, 9875, 3053, 1760, 3710, 7928, 9338, 4328, 9870, 6125, 5128, 296, 6615, 650, 4198, 9990, 6743, 9625, 7691, 9398, 7957, 295, 5811, 5078, 2654, 7571, 5555, 6594, 8820, 7252, 9601, 1743, 7968, 4265, 9592, 9224, 514, 3061, 5824, 7464, 341, 7111, 4801, 9413, 8031, 1347, 8044, 8382, 6183, 662, 4827, 3641, 3058, 7080, 230, 627, 389, 6571, 6606, 4961, 4771, 9535, 7614, 9273, 6246, 296, 3714, 2411, 833, 9329, 4749, 973, 9559, 8692, 8147, 1578, 4080, 7577, 2088, 955, 8817, 6136, 1346, 9166, 939, 1317, 9167, 6367, 3743, 671, 2798, 87, 6463, 9319, 8122, 8234, 8155, 9649, 3370, 5192, 4725, 7082, 5057, 4207, 4205, 121, 5922, 1299, 6831, 6761, 2972, 6369, 4196, 5859, 1372, 4855, 7958, 1465, 9793, 642, 9926, 9244, 4021, 8332, 3131, 942, 5148, 7361, 9853, 5327, 9119, 5349, 5641, 2676, 3371, 1911, 1707, 8139, 7667, 6509, 1984, 4310, 8855, 7501, 1656, 3642, 6415, 5369, 1297, 4682, 9972, 889, 3005, 6487, 1877, 8414, 5047, 1385, 5708, 1336, 1775, 9888, 8049, 4189, 7019, 6207, 8142, 547, 829, 3021, 8443, 1457, 3128, 9274, 4680, 8938, 3979, 6728, 6409, 6548, 766, 3388, 3310, 7029, 3127, 6460, 4528, 7536, 8668, 6245, 5824, 9265, 3519, 8901, 1782, 4754, 2828, 7040, 4614, 7956, 9025, 5067, 3010, 3200, 4226, 8994, 8664, 1222, 7044, 4587, 7653, 7815, 8013, 897, 6425, 2023, 5387, 5306, 8531, 1228, 634, 2846, 5603, 235, 567, 2399, 2555, 3511, 4888, 2454, 7316, 7231, 5084, 6756, 7356, 54, 4919, 4414, 8957, 4922, 5299, 1106, 9475, 7772, 534, 9713, 459, 7935, 3740, 7057, 4908, 9433, 5701, 331, 1245, 2803, 2647, 5900, 5705, 543, 2937, 302, 8309, 5949, 318, 557, 2310, 873, 3473, 2702, 6380, 2203, 8503, 5494, 9518, 3972, 5832, 1644, 9203, 7361, 140, 2104, 915, 8526, 7917, 4211, 1612, 1243, 2973, 9094, 5724, 8540, 8659, 2368, 8055, 4914, 9570, 4989, 1170, 7987, 3081, 4424, 4243, 6588, 8035, 2210, 9216, 464, 7975, 2516, 7911, 6626, 5458, 4431, 6489, 9224, 9231, 2294, 3093, 1011, 5005, 8077, 2910, 6143, 5498, 5961, 8618, 6027, 1975, 4359, 6569, 3518, 5757, 169, 750, 4941, 9262, 1000, 2069, 2805, 8329, 2051, 2461, 5173, 2057, 9001, 8772, 9004, 1426, 9105, 8441, 5253, 9710, 3061, 8151, 7012, 5808, 180, 255, 3590, 1125, 5111, 978, 4574, 2525, 8735, 1500, 3830, 3337, 5736, 3967, 5253, 1282, 2140, 519, 9601, 975, 9779, 378, 8426, 2810, 5550, 3859, 4767, 5893, 675, 7279, 35, 678, 3721, 2173, 796, 1571, 169, 2423, 9808, 8003, 791, 7409, 589, 4411, 6512, 8501, 7476, 8729, 7857, 2601, 5403, 7794, 8972, 6128, 4957, 7801, 4075, 6577, 2172, 9187, 4009, 9925, 8681, 9514, 7072, 3251, 6963, 8107, 1099, 298, 2520, 3164, 2507, 1448, 4586, 2391, 6126, 7144, 4572, 7906, 6545, 3181, 1729, 7616, 3429, 3765, 8218, 7225, 671, 7471, 2859, 5810, 4657, 1645, 9568, 8580, 3316, 9907, 8569, 5424, 6316, 1541, 1622, 318, 455, 996, 7066, 143, 3422, 5732, 2739, 3862, 9923, 8626, 7814, 2831, 8775, 1674, 1689, 1845, 7189, 8848, 2775, 1847}, 823688619));
        System.out.println(minOperations_dfs(new int[]{9677, 8800, 4181, 5725, 1936, 9989, 2950, 630, 1045, 7471, 2853, 7557, 8279, 6189, 9110, 9274, 8161, 7216, 2159, 3993, 9991, 8992, 2084, 687, 3221, 8675, 7167, 4373, 5326, 9977, 6615, 3065, 7575, 738, 4000, 1196, 8303, 2697, 7901, 3171, 6265, 200, 2865, 8786, 5419, 2821, 3081, 6327, 323, 2652, 8971, 8031, 3417, 2539, 9080, 4831, 1513, 5067, 5835, 482, 3231, 3656, 1361, 2769, 5570, 9832, 4527, 9890, 4992, 8613, 782, 3051, 6766, 7709, 6759, 9646, 4724, 8025, 8508, 4680, 4691, 1248, 4386, 5971, 3717, 425, 6066, 1091, 879, 53, 6055, 9781, 3322, 1652, 2902, 8153, 4144, 2293, 4023, 4430, 2168, 1072, 4182, 3709, 4786, 9650, 4981, 2762, 286, 8234, 802, 589, 9838, 8027, 7884, 4949, 3943, 4040, 4521, 2327, 5338, 3374, 2276, 3209, 450, 203, 125, 9525, 2313, 4142, 9250, 2628, 7640, 6889, 9111, 8824, 9326, 4855, 1744, 2239, 5299, 6531, 3164, 1170, 5451, 9647, 8820, 8025, 9091, 841, 9462, 1175, 4305, 781, 8791, 723, 6374, 6865, 2750, 8843, 3529, 3716, 1030, 7768, 1552, 9145, 3323, 7587, 6872, 1308, 4035, 6559, 2822, 4133, 7847, 2132, 9227, 7808, 1541, 5222, 8864, 8152, 5547, 5743, 4143, 4297, 9461, 3681, 7625, 6170, 9964, 9438, 6290, 3609, 8987, 5463, 720, 915, 4891, 5239, 7030, 5074, 3369, 9764, 5098, 9750, 1934, 4674, 9791, 8423, 1548, 5092, 4497, 1425, 4367, 4852, 3791, 2823, 3368, 5978, 6958, 4132, 5580, 4516, 7184, 1601, 4752, 9249, 2666, 3034, 1941, 6044, 1162, 4615, 7343, 3683, 1475, 5945, 4172, 5785, 1582, 4703, 1986, 9101, 4353, 9243, 8530, 8433, 2937, 4160, 7913, 2032, 1949, 5473, 8309, 5610, 8102, 2773, 730, 4829, 6658, 2919, 6920, 648, 8631, 4456, 7870, 335, 3775, 6930, 9846, 3590, 5701, 3206, 3027, 5536, 3797, 8618, 6995, 9051, 2991, 2020, 8032, 9765, 7507, 5396, 7056, 911, 9526, 3706, 7037, 3607, 821, 1080, 137, 9150, 5426, 9452, 4999, 152, 1582, 7533, 155, 7711, 6266, 1483, 3391, 298, 7632, 7866, 2292, 5370, 7830, 5393, 861, 8244, 8317, 1386, 4087, 1724, 2064, 287, 236, 6413, 1107, 3916, 9210, 5551, 1215, 4716, 2700, 7655, 8248, 5326, 2190, 7768, 2162, 8147, 6777, 9500, 7404, 8477, 5124, 5365, 7656, 6205, 4141, 2325, 2323, 8941, 2362, 877, 1238, 2511, 8066, 3925, 3346, 6199, 2297, 6354, 3744, 2550, 4880, 1316, 1221, 7154, 5901, 6523, 6569, 1538, 7452, 6762, 2091, 1032, 8186, 6566, 3896, 1461, 3465, 7504, 3872, 7438, 7889, 2143, 6878, 5959, 5409, 7209, 7293, 169, 1738, 2322, 2022, 2033, 3482, 1326, 8896, 7949, 8556, 6995, 6806, 7858, 7885, 7422, 97, 2988, 9728, 5824, 7340, 5919, 1112, 4695, 774, 4530, 9651, 8986, 3937, 2908, 7192, 1909, 5915, 2738, 3378, 9484, 3873, 5894, 6579, 6734, 9749, 4699, 4184, 4979, 5346, 3789, 258, 5322, 646, 5572, 104, 9206, 6917, 5813, 1652, 7135, 4077, 2669, 5888, 647, 2710, 5589, 2427, 4886, 1793, 8248, 5746, 3353, 8671, 457, 6831, 6894, 1317, 7538, 1679, 1, 6557, 3307, 2755, 4531, 573, 8981, 9834, 2013, 4547, 9935, 6564, 8135, 3282, 3870, 4645, 8343, 3989, 883, 4826, 8314, 5792, 1108, 9723, 7820, 8030, 8701, 6533, 3847, 775, 3901, 8321, 8864, 2396, 7367, 9010, 1967, 4651, 373, 6715, 4699, 6128, 891, 4357, 2248, 7661, 5428, 7353, 9164, 2935, 3547, 7872, 1329, 1720, 1448, 4976, 8777, 4038, 1627, 4421, 2495, 8644, 3769, 2323, 7254, 7290, 6304, 1263, 5080, 130, 5866, 9920, 5776, 8547, 3995, 3576, 6480, 8522, 4854, 4516, 9532, 3667, 7794, 6163, 3489, 3639, 9856, 6598, 1211, 2015, 8485, 1171, 4644, 6312, 230, 2146, 5910, 3305, 7412, 8450, 2756, 5384, 9323, 3771, 7307, 5595, 8401, 4987, 6524, 782, 9804, 5416, 9426, 1843, 1369, 3399, 782, 5933, 3125, 935, 4117, 803, 5476, 9063, 8892, 9227, 8265, 5631, 6652, 9329, 3760, 7617, 9971, 2368, 8664, 944, 7062, 5024, 3819, 1653, 6457, 5877, 9783, 6007, 787, 5451, 2068, 514, 453, 4787, 7669, 1768, 6816, 1075, 6104, 7034, 41, 8063, 1474, 2972, 875, 6169, 7429, 574, 2553, 334, 41, 5063, 3484, 3468, 4277, 5413, 9639, 2515, 9082, 3862, 2671, 6142, 4564, 6621, 376, 6818, 7803, 813, 8327, 2617, 4240, 5514, 1397, 7102, 2794, 4246, 209, 8322, 1889, 1205, 4495, 4795, 453, 1196, 6004, 8215, 7984, 5445, 3689, 6363, 9171, 3839, 1483, 2763, 6236, 9020, 9415, 4218, 1410, 862, 1052, 937, 174, 3338, 5060, 4657, 285, 1940, 5842, 9250, 3946, 8743, 7033, 4400, 54, 4227, 6681, 7852, 2379, 7849, 3537, 872, 4982, 2552, 330, 4382, 710, 2868, 5613, 4680, 9845, 8185, 6174, 2763, 9109, 3785, 5369, 8066, 2205, 8465, 7477, 8312, 2341, 3436, 7344, 5561, 4876, 4846, 8331, 4955, 6530, 5389, 5077, 9866, 502, 4034, 5408, 5243, 3137, 6684, 8011, 2451, 1909, 8231, 9157, 2476, 3495, 5910, 2790, 6873, 5238, 1251, 6975, 9844, 1577, 4571, 4595, 2156, 3877, 7085, 2514, 5380, 2778, 224, 515, 8004, 679, 46, 6414, 8424, 2333, 6107, 5241, 1589, 3213, 2639, 1937, 7448, 2832, 3940, 5114, 60, 4326, 5463, 8262, 5550, 5403, 2611, 158, 864, 7078, 6935, 106, 8983, 1234, 895, 4826, 6786, 7988, 6373, 7130, 1605, 7330, 1605, 6421, 9052, 6394, 9744, 5774, 2691, 7854, 4188, 3877, 3864, 7001, 9853, 300, 1933, 8902, 4483, 8880, 9582, 9599, 9407, 8205, 4645, 8166, 6603, 633, 5860, 9706, 1830, 9675, 1816, 956, 8186, 8966, 195, 2578, 2833, 2309, 7955, 5696, 9163, 2713, 8249, 2553, 6753, 166, 2775, 1995, 2438, 8906, 9072, 2113, 3634, 7218, 192, 425, 2270, 1144, 3617, 408, 6325, 4839, 4955, 5000, 6171, 6162, 5307, 6745, 4693, 5006, 7493, 5823, 2865, 8526, 2208, 4796, 9264, 8171, 2853, 8771, 6707, 9295, 1099, 2602, 9207, 7623, 3611, 2408, 5133, 9386, 9739, 3277, 9910, 9284, 5611, 5110, 9540, 6610, 6124, 5483, 8782, 9406, 2323, 3239, 8654, 4930, 776, 6818, 8899, 4973, 4455, 5231, 4642, 1838, 7280}, 284132523));
        System.out.println(minOperations_dfs(new int[]{6388, 817, 7938, 1058, 2185, 2516, 1766, 7448, 9210, 8391, 7301, 2645, 5698, 5312, 6697, 1662, 3604, 8384, 4316, 5195, 17, 7694, 9640, 1283, 3223, 3192, 6098, 8679, 9475, 6881, 697, 4252, 9214, 1299, 5856, 3408, 869, 8525, 8048, 3857, 8264, 1559, 6062, 6118, 2478, 5579, 1151, 9879, 7497, 5882, 345, 5084, 1740, 4015, 9456, 5632, 6494, 3458, 8770, 337, 9620, 4555, 7095, 8837, 6090, 2380, 4410, 4240, 5108, 246, 1811, 1325, 7759, 2842, 2328, 3335, 4990, 7853, 4991, 5001, 5388, 720, 4020, 3911, 2318, 9782, 5051, 276, 5918, 6225, 9965, 4996, 9069, 9021, 3330, 5657, 2430, 8417, 4815, 3699, 6162, 8619, 225, 8857, 4179, 3171, 2417, 5327, 6583, 6393, 2192, 9394, 9502, 2267, 9721, 5289, 2866, 6994, 7548, 2804, 4931, 2673, 6219, 6009, 6436, 9153, 9820, 5649, 2970, 1983, 6295, 2984, 5850, 5003, 9219, 4290, 1278, 8920, 2233, 6738, 7324, 5779, 4152, 6820, 4169, 9431, 1451, 3141, 1139, 1950, 4627, 7454, 6966, 9541, 7620, 8000, 6701, 4376, 9713, 4152, 1693, 1811, 7798, 7266, 286, 5268, 5606, 234, 9982, 1901, 8143, 5835, 2079, 8681, 6937, 3667, 8001, 1541, 9459, 586, 8211, 3300, 9639, 1286, 7033, 6802, 9096, 9130, 1751, 8377, 4132, 8281, 1425, 9541, 5501, 9504, 6257, 37, 7916, 6419, 8483, 9324, 7026, 3967, 2226, 3807, 3507, 378, 5042, 8304, 9972, 4030, 1730, 5790, 3897, 7435, 1878, 4393, 2236, 8704, 6315, 6057, 395, 2138, 5319, 6806, 5216, 2816, 1633, 1462, 5796, 8334, 1240, 7269, 9756, 3439, 7404, 9542, 7113, 9015, 3547, 596, 105, 7141, 7146, 2757, 4413, 9752, 794, 9803, 566, 6703, 6857, 5320, 272, 3917, 8823, 3975, 9395, 3412, 4554, 7838, 7651, 2943, 5446, 4170, 3025, 4529, 5996, 7956, 6571, 2794, 1438, 18, 2906, 7485, 8172, 5459, 1536, 1719, 1759, 33, 3329, 3645, 4409, 4265, 4784, 4044, 964, 705, 9110, 4417, 5766, 9243, 1545, 5877, 684, 6329, 1507, 5267, 5238, 3789, 7601, 4596, 206, 4080, 2132, 2213, 1906, 2017, 407, 575, 5223, 9646, 3296, 4046, 4647, 9664, 985, 8646, 9696, 1581, 8009, 9790, 2857, 5494, 5824, 3215, 2958, 8569, 8253, 3131, 8513, 8098, 3085, 8662, 6661, 8735, 408, 5765, 584, 6809, 256, 9182, 7724, 5123, 5040, 1243, 3760, 5288, 1311, 6319, 4050, 7246, 9104, 5553, 7778, 7718, 5075, 1755, 8008, 4335, 3268, 4675, 701, 7867, 175, 1454, 2990, 6710, 9476, 9744, 7686, 5826, 5379, 7379, 1882, 3266, 2205, 5205, 5094, 8064, 1065, 4819, 5492, 7009, 9368, 810, 9799, 4685, 6245, 9393, 1666, 5698, 8500, 6312, 8126, 5084, 9051, 2672, 2509, 1901, 9807, 6964, 8427, 6269, 7044, 7199, 7287, 6512, 7673, 621, 4784, 9168, 4959, 7410, 4782, 2595, 8086, 5875, 7880, 9090, 3821, 8244, 7949, 1564, 9342, 6501, 4018, 5669, 2714, 8628, 3041, 2934, 1385, 3639, 5274, 1128, 6773, 2920, 5181, 1352, 2753, 6676, 5200, 7289, 4013, 6, 7124, 1538, 1695, 6802, 4701, 1190, 4628, 3145, 9246, 2168, 564, 8913, 5782, 5476, 2462, 8907, 26, 1456, 7671, 3345, 8120, 7952, 2827, 3519, 2495, 5558, 9799, 7768, 150, 6957, 1798, 9965, 5626, 334, 1914, 7003, 901, 8789, 5180, 54, 5717, 7480, 5559, 6662, 4382, 5852, 2582, 3359, 6042, 1385, 2577, 3156, 6715, 8496, 9578, 3799, 5903, 6018, 9196, 1770, 5964, 2261, 3792, 5185, 9310, 3359, 9057, 4024, 6067, 4104, 8272, 3434, 8064, 9233, 292, 1778, 8519, 2395, 4095, 3674, 7897, 5733, 1198, 8363, 6928, 1504, 4901, 5379, 9112, 4707, 9737, 5727, 2206, 7351, 8172, 9433, 3387, 1815, 9551, 482, 7100, 4680, 9329, 8116, 2684, 4394, 1554, 5680, 8041, 5560, 7697, 5566, 8716, 3283, 2555, 8401, 357, 5524, 484, 7317, 1933, 5833, 3361, 893, 814, 9042, 3330, 9145, 6817, 7949, 4822, 7666, 3828, 6571, 3109, 5226, 8234, 5013, 7873, 4749, 9180, 695, 9870, 5027, 6150, 1316, 7340, 6276, 3684, 8456, 9233, 5902, 900, 4266, 5042, 5626, 3340, 1755, 2313, 2532, 6229, 2210, 2277, 440, 2619, 8231, 7211, 9626, 5276, 8390, 6310, 3330, 4735, 3277, 7705, 2396, 1167, 4040, 2392, 3639, 9992, 9805, 5603, 7393, 5737, 14, 5769, 9720, 5651, 6942, 5949, 6598, 5835, 3392, 557, 1672, 4763, 5047, 4579, 9973, 9381, 2642, 8915, 6209, 3305, 8141, 3400, 5629, 983, 5222, 4347, 3081, 8774}, 1806040));
        System.out.println("********************************************* Solution 3 ********************************************");
        System.out.println(minOperations_bfs(new int[]{1, 1, 4, 2, 3}, 5));
        System.out.println(minOperations_bfs(new int[]{8828, 9581, 49, 9818, 9974, 9869, 9991, 10000, 10000, 10000, 9999, 9993, 9904, 8819, 1231, 6309}, 134365));
        System.out.println(minOperations_bfs(new int[]{5366, 6197, 4837, 2228, 2306, 3612, 3045, 2795, 3815, 1958, 3620, 4791, 2208, 460, 28, 2155, 9401, 2973, 6075, 8909, 3546, 42, 367, 2115, 3660, 4112, 6409, 5493, 9336, 7725, 6207, 6197, 8301, 6633, 3396, 7707, 1788, 6472, 7635, 1701, 1774, 8732, 7528, 2337, 387, 5951, 377, 6643, 5432, 7427, 8793, 1918, 973, 6742, 4826, 4046, 1608, 3627, 6695, 4054, 2930, 4697, 4988, 1713, 7807, 2302, 5495, 9187, 9088, 5121, 9051, 2236, 6001, 3344, 8962, 8587, 1432, 8400, 9819, 6340, 2650, 2823, 6787, 873, 8253, 9404, 3035, 8498, 8061, 5269, 3599, 9748, 7682, 4108, 3482, 9848, 8926, 2451, 7570, 9110, 6416, 7939, 19, 5082, 4586, 895, 428, 2968, 6882, 9817, 5053, 9259, 6433, 2834, 6246, 9374, 7178, 5183, 2954, 694, 5765, 2363, 6568, 6587, 2024, 7624, 8806, 680, 4513, 2993, 2291, 7298, 6048, 8631, 3730, 9380, 4493, 1199, 8309, 6313, 1069, 8219, 7554, 77, 2005, 1367, 674, 2392, 6964, 1484, 3328, 6512, 6696, 9116, 3439, 9516, 991, 6881, 2770, 1138, 2677, 8047, 5067, 2672, 3264, 8310, 269, 2206, 6320, 1996, 3884, 1051, 6879, 4808, 3685, 4466, 10, 8080, 4987, 3387, 7092, 1690, 7018, 4230, 1204, 4626, 2439, 6948, 719, 3110, 8429, 4806, 5927, 9997, 1428, 8307, 5677, 629, 6326, 2625, 2142, 5536, 603, 1630, 2690, 6983, 1066, 1187, 4107, 5677, 8143, 1683, 9315, 2500, 2467, 3555, 4175, 9802, 184, 7850, 47, 6701, 8566, 2147, 13, 9880, 6424, 1753, 1173, 9551, 3691, 4254, 9356, 2543, 6308, 7926, 8507, 3518, 4736, 5548, 9220, 4949, 6868, 488, 4091, 9503, 2691, 6521, 8292, 2567, 6586, 2806, 8070, 736, 1589, 8557, 8132, 9661, 7629, 378, 2035, 4677, 1868, 2737, 3453, 4448, 1702, 2592, 5733, 7517, 3432, 729, 3443, 1736, 9239, 9588, 4751, 7263, 8824, 7204, 7373, 4010, 7022, 4048, 4611, 8824, 4302, 327, 5359, 6293, 4176, 7618, 5030, 3593, 6838, 3224, 7979, 7473, 5567, 9985, 8678, 7809, 4438, 9500, 4621, 3455, 8365, 9313, 1227, 3484, 1407, 7502, 1600, 9564, 6176, 7921, 2070, 4481, 1431, 9742, 2038, 410, 1700, 1531, 1248, 4290, 1912, 7089, 2729, 6780, 916, 1258, 5366, 8667, 4695, 2969, 8397, 6333, 3543, 1965, 7545, 4133, 6316, 4722, 286, 8775, 1674, 9940, 5643, 3115, 4642, 6778, 3092, 742, 5701, 594, 5712, 1950, 3346, 7846, 3673, 4850, 5325, 2350, 6873, 6510, 856, 5884, 8925, 373, 3598, 9197, 138, 6045, 1777, 4143, 9875, 3053, 1760, 3710, 7928, 9338, 4328, 9870, 6125, 5128, 296, 6615, 650, 4198, 9990, 6743, 9625, 7691, 9398, 7957, 295, 5811, 5078, 2654, 7571, 5555, 6594, 8820, 7252, 9601, 1743, 7968, 4265, 9592, 9224, 514, 3061, 5824, 7464, 341, 7111, 4801, 9413, 8031, 1347, 8044, 8382, 6183, 662, 4827, 3641, 3058, 7080, 230, 627, 389, 6571, 6606, 4961, 4771, 9535, 7614, 9273, 6246, 296, 3714, 2411, 833, 9329, 4749, 973, 9559, 8692, 8147, 1578, 4080, 7577, 2088, 955, 8817, 6136, 1346, 9166, 939, 1317, 9167, 6367, 3743, 671, 2798, 87, 6463, 9319, 8122, 8234, 8155, 9649, 3370, 5192, 4725, 7082, 5057, 4207, 4205, 121, 5922, 1299, 6831, 6761, 2972, 6369, 4196, 5859, 1372, 4855, 7958, 1465, 9793, 642, 9926, 9244, 4021, 8332, 3131, 942, 5148, 7361, 9853, 5327, 9119, 5349, 5641, 2676, 3371, 1911, 1707, 8139, 7667, 6509, 1984, 4310, 8855, 7501, 1656, 3642, 6415, 5369, 1297, 4682, 9972, 889, 3005, 6487, 1877, 8414, 5047, 1385, 5708, 1336, 1775, 9888, 8049, 4189, 7019, 6207, 8142, 547, 829, 3021, 8443, 1457, 3128, 9274, 4680, 8938, 3979, 6728, 6409, 6548, 766, 3388, 3310, 7029, 3127, 6460, 4528, 7536, 8668, 6245, 5824, 9265, 3519, 8901, 1782, 4754, 2828, 7040, 4614, 7956, 9025, 5067, 3010, 3200, 4226, 8994, 8664, 1222, 7044, 4587, 7653, 7815, 8013, 897, 6425, 2023, 5387, 5306, 8531, 1228, 634, 2846, 5603, 235, 567, 2399, 2555, 3511, 4888, 2454, 7316, 7231, 5084, 6756, 7356, 54, 4919, 4414, 8957, 4922, 5299, 1106, 9475, 7772, 534, 9713, 459, 7935, 3740, 7057, 4908, 9433, 5701, 331, 1245, 2803, 2647, 5900, 5705, 543, 2937, 302, 8309, 5949, 318, 557, 2310, 873, 3473, 2702, 6380, 2203, 8503, 5494, 9518, 3972, 5832, 1644, 9203, 7361, 140, 2104, 915, 8526, 7917, 4211, 1612, 1243, 2973, 9094, 5724, 8540, 8659, 2368, 8055, 4914, 9570, 4989, 1170, 7987, 3081, 4424, 4243, 6588, 8035, 2210, 9216, 464, 7975, 2516, 7911, 6626, 5458, 4431, 6489, 9224, 9231, 2294, 3093, 1011, 5005, 8077, 2910, 6143, 5498, 5961, 8618, 6027, 1975, 4359, 6569, 3518, 5757, 169, 750, 4941, 9262, 1000, 2069, 2805, 8329, 2051, 2461, 5173, 2057, 9001, 8772, 9004, 1426, 9105, 8441, 5253, 9710, 3061, 8151, 7012, 5808, 180, 255, 3590, 1125, 5111, 978, 4574, 2525, 8735, 1500, 3830, 3337, 5736, 3967, 5253, 1282, 2140, 519, 9601, 975, 9779, 378, 8426, 2810, 5550, 3859, 4767, 5893, 675, 7279, 35, 678, 3721, 2173, 796, 1571, 169, 2423, 9808, 8003, 791, 7409, 589, 4411, 6512, 8501, 7476, 8729, 7857, 2601, 5403, 7794, 8972, 6128, 4957, 7801, 4075, 6577, 2172, 9187, 4009, 9925, 8681, 9514, 7072, 3251, 6963, 8107, 1099, 298, 2520, 3164, 2507, 1448, 4586, 2391, 6126, 7144, 4572, 7906, 6545, 3181, 1729, 7616, 3429, 3765, 8218, 7225, 671, 7471, 2859, 5810, 4657, 1645, 9568, 8580, 3316, 9907, 8569, 5424, 6316, 1541, 1622, 318, 455, 996, 7066, 143, 3422, 5732, 2739, 3862, 9923, 8626, 7814, 2831, 8775, 1674, 1689, 1845, 7189, 8848, 2775, 1847}, 823688619));
        System.out.println(minOperations_bfs(new int[]{9677, 8800, 4181, 5725, 1936, 9989, 2950, 630, 1045, 7471, 2853, 7557, 8279, 6189, 9110, 9274, 8161, 7216, 2159, 3993, 9991, 8992, 2084, 687, 3221, 8675, 7167, 4373, 5326, 9977, 6615, 3065, 7575, 738, 4000, 1196, 8303, 2697, 7901, 3171, 6265, 200, 2865, 8786, 5419, 2821, 3081, 6327, 323, 2652, 8971, 8031, 3417, 2539, 9080, 4831, 1513, 5067, 5835, 482, 3231, 3656, 1361, 2769, 5570, 9832, 4527, 9890, 4992, 8613, 782, 3051, 6766, 7709, 6759, 9646, 4724, 8025, 8508, 4680, 4691, 1248, 4386, 5971, 3717, 425, 6066, 1091, 879, 53, 6055, 9781, 3322, 1652, 2902, 8153, 4144, 2293, 4023, 4430, 2168, 1072, 4182, 3709, 4786, 9650, 4981, 2762, 286, 8234, 802, 589, 9838, 8027, 7884, 4949, 3943, 4040, 4521, 2327, 5338, 3374, 2276, 3209, 450, 203, 125, 9525, 2313, 4142, 9250, 2628, 7640, 6889, 9111, 8824, 9326, 4855, 1744, 2239, 5299, 6531, 3164, 1170, 5451, 9647, 8820, 8025, 9091, 841, 9462, 1175, 4305, 781, 8791, 723, 6374, 6865, 2750, 8843, 3529, 3716, 1030, 7768, 1552, 9145, 3323, 7587, 6872, 1308, 4035, 6559, 2822, 4133, 7847, 2132, 9227, 7808, 1541, 5222, 8864, 8152, 5547, 5743, 4143, 4297, 9461, 3681, 7625, 6170, 9964, 9438, 6290, 3609, 8987, 5463, 720, 915, 4891, 5239, 7030, 5074, 3369, 9764, 5098, 9750, 1934, 4674, 9791, 8423, 1548, 5092, 4497, 1425, 4367, 4852, 3791, 2823, 3368, 5978, 6958, 4132, 5580, 4516, 7184, 1601, 4752, 9249, 2666, 3034, 1941, 6044, 1162, 4615, 7343, 3683, 1475, 5945, 4172, 5785, 1582, 4703, 1986, 9101, 4353, 9243, 8530, 8433, 2937, 4160, 7913, 2032, 1949, 5473, 8309, 5610, 8102, 2773, 730, 4829, 6658, 2919, 6920, 648, 8631, 4456, 7870, 335, 3775, 6930, 9846, 3590, 5701, 3206, 3027, 5536, 3797, 8618, 6995, 9051, 2991, 2020, 8032, 9765, 7507, 5396, 7056, 911, 9526, 3706, 7037, 3607, 821, 1080, 137, 9150, 5426, 9452, 4999, 152, 1582, 7533, 155, 7711, 6266, 1483, 3391, 298, 7632, 7866, 2292, 5370, 7830, 5393, 861, 8244, 8317, 1386, 4087, 1724, 2064, 287, 236, 6413, 1107, 3916, 9210, 5551, 1215, 4716, 2700, 7655, 8248, 5326, 2190, 7768, 2162, 8147, 6777, 9500, 7404, 8477, 5124, 5365, 7656, 6205, 4141, 2325, 2323, 8941, 2362, 877, 1238, 2511, 8066, 3925, 3346, 6199, 2297, 6354, 3744, 2550, 4880, 1316, 1221, 7154, 5901, 6523, 6569, 1538, 7452, 6762, 2091, 1032, 8186, 6566, 3896, 1461, 3465, 7504, 3872, 7438, 7889, 2143, 6878, 5959, 5409, 7209, 7293, 169, 1738, 2322, 2022, 2033, 3482, 1326, 8896, 7949, 8556, 6995, 6806, 7858, 7885, 7422, 97, 2988, 9728, 5824, 7340, 5919, 1112, 4695, 774, 4530, 9651, 8986, 3937, 2908, 7192, 1909, 5915, 2738, 3378, 9484, 3873, 5894, 6579, 6734, 9749, 4699, 4184, 4979, 5346, 3789, 258, 5322, 646, 5572, 104, 9206, 6917, 5813, 1652, 7135, 4077, 2669, 5888, 647, 2710, 5589, 2427, 4886, 1793, 8248, 5746, 3353, 8671, 457, 6831, 6894, 1317, 7538, 1679, 1, 6557, 3307, 2755, 4531, 573, 8981, 9834, 2013, 4547, 9935, 6564, 8135, 3282, 3870, 4645, 8343, 3989, 883, 4826, 8314, 5792, 1108, 9723, 7820, 8030, 8701, 6533, 3847, 775, 3901, 8321, 8864, 2396, 7367, 9010, 1967, 4651, 373, 6715, 4699, 6128, 891, 4357, 2248, 7661, 5428, 7353, 9164, 2935, 3547, 7872, 1329, 1720, 1448, 4976, 8777, 4038, 1627, 4421, 2495, 8644, 3769, 2323, 7254, 7290, 6304, 1263, 5080, 130, 5866, 9920, 5776, 8547, 3995, 3576, 6480, 8522, 4854, 4516, 9532, 3667, 7794, 6163, 3489, 3639, 9856, 6598, 1211, 2015, 8485, 1171, 4644, 6312, 230, 2146, 5910, 3305, 7412, 8450, 2756, 5384, 9323, 3771, 7307, 5595, 8401, 4987, 6524, 782, 9804, 5416, 9426, 1843, 1369, 3399, 782, 5933, 3125, 935, 4117, 803, 5476, 9063, 8892, 9227, 8265, 5631, 6652, 9329, 3760, 7617, 9971, 2368, 8664, 944, 7062, 5024, 3819, 1653, 6457, 5877, 9783, 6007, 787, 5451, 2068, 514, 453, 4787, 7669, 1768, 6816, 1075, 6104, 7034, 41, 8063, 1474, 2972, 875, 6169, 7429, 574, 2553, 334, 41, 5063, 3484, 3468, 4277, 5413, 9639, 2515, 9082, 3862, 2671, 6142, 4564, 6621, 376, 6818, 7803, 813, 8327, 2617, 4240, 5514, 1397, 7102, 2794, 4246, 209, 8322, 1889, 1205, 4495, 4795, 453, 1196, 6004, 8215, 7984, 5445, 3689, 6363, 9171, 3839, 1483, 2763, 6236, 9020, 9415, 4218, 1410, 862, 1052, 937, 174, 3338, 5060, 4657, 285, 1940, 5842, 9250, 3946, 8743, 7033, 4400, 54, 4227, 6681, 7852, 2379, 7849, 3537, 872, 4982, 2552, 330, 4382, 710, 2868, 5613, 4680, 9845, 8185, 6174, 2763, 9109, 3785, 5369, 8066, 2205, 8465, 7477, 8312, 2341, 3436, 7344, 5561, 4876, 4846, 8331, 4955, 6530, 5389, 5077, 9866, 502, 4034, 5408, 5243, 3137, 6684, 8011, 2451, 1909, 8231, 9157, 2476, 3495, 5910, 2790, 6873, 5238, 1251, 6975, 9844, 1577, 4571, 4595, 2156, 3877, 7085, 2514, 5380, 2778, 224, 515, 8004, 679, 46, 6414, 8424, 2333, 6107, 5241, 1589, 3213, 2639, 1937, 7448, 2832, 3940, 5114, 60, 4326, 5463, 8262, 5550, 5403, 2611, 158, 864, 7078, 6935, 106, 8983, 1234, 895, 4826, 6786, 7988, 6373, 7130, 1605, 7330, 1605, 6421, 9052, 6394, 9744, 5774, 2691, 7854, 4188, 3877, 3864, 7001, 9853, 300, 1933, 8902, 4483, 8880, 9582, 9599, 9407, 8205, 4645, 8166, 6603, 633, 5860, 9706, 1830, 9675, 1816, 956, 8186, 8966, 195, 2578, 2833, 2309, 7955, 5696, 9163, 2713, 8249, 2553, 6753, 166, 2775, 1995, 2438, 8906, 9072, 2113, 3634, 7218, 192, 425, 2270, 1144, 3617, 408, 6325, 4839, 4955, 5000, 6171, 6162, 5307, 6745, 4693, 5006, 7493, 5823, 2865, 8526, 2208, 4796, 9264, 8171, 2853, 8771, 6707, 9295, 1099, 2602, 9207, 7623, 3611, 2408, 5133, 9386, 9739, 3277, 9910, 9284, 5611, 5110, 9540, 6610, 6124, 5483, 8782, 9406, 2323, 3239, 8654, 4930, 776, 6818, 8899, 4973, 4455, 5231, 4642, 1838, 7280}, 284132523));
        System.out.println(minOperations_bfs(new int[]{6388, 817, 7938, 1058, 2185, 2516, 1766, 7448, 9210, 8391, 7301, 2645, 5698, 5312, 6697, 1662, 3604, 8384, 4316, 5195, 17, 7694, 9640, 1283, 3223, 3192, 6098, 8679, 9475, 6881, 697, 4252, 9214, 1299, 5856, 3408, 869, 8525, 8048, 3857, 8264, 1559, 6062, 6118, 2478, 5579, 1151, 9879, 7497, 5882, 345, 5084, 1740, 4015, 9456, 5632, 6494, 3458, 8770, 337, 9620, 4555, 7095, 8837, 6090, 2380, 4410, 4240, 5108, 246, 1811, 1325, 7759, 2842, 2328, 3335, 4990, 7853, 4991, 5001, 5388, 720, 4020, 3911, 2318, 9782, 5051, 276, 5918, 6225, 9965, 4996, 9069, 9021, 3330, 5657, 2430, 8417, 4815, 3699, 6162, 8619, 225, 8857, 4179, 3171, 2417, 5327, 6583, 6393, 2192, 9394, 9502, 2267, 9721, 5289, 2866, 6994, 7548, 2804, 4931, 2673, 6219, 6009, 6436, 9153, 9820, 5649, 2970, 1983, 6295, 2984, 5850, 5003, 9219, 4290, 1278, 8920, 2233, 6738, 7324, 5779, 4152, 6820, 4169, 9431, 1451, 3141, 1139, 1950, 4627, 7454, 6966, 9541, 7620, 8000, 6701, 4376, 9713, 4152, 1693, 1811, 7798, 7266, 286, 5268, 5606, 234, 9982, 1901, 8143, 5835, 2079, 8681, 6937, 3667, 8001, 1541, 9459, 586, 8211, 3300, 9639, 1286, 7033, 6802, 9096, 9130, 1751, 8377, 4132, 8281, 1425, 9541, 5501, 9504, 6257, 37, 7916, 6419, 8483, 9324, 7026, 3967, 2226, 3807, 3507, 378, 5042, 8304, 9972, 4030, 1730, 5790, 3897, 7435, 1878, 4393, 2236, 8704, 6315, 6057, 395, 2138, 5319, 6806, 5216, 2816, 1633, 1462, 5796, 8334, 1240, 7269, 9756, 3439, 7404, 9542, 7113, 9015, 3547, 596, 105, 7141, 7146, 2757, 4413, 9752, 794, 9803, 566, 6703, 6857, 5320, 272, 3917, 8823, 3975, 9395, 3412, 4554, 7838, 7651, 2943, 5446, 4170, 3025, 4529, 5996, 7956, 6571, 2794, 1438, 18, 2906, 7485, 8172, 5459, 1536, 1719, 1759, 33, 3329, 3645, 4409, 4265, 4784, 4044, 964, 705, 9110, 4417, 5766, 9243, 1545, 5877, 684, 6329, 1507, 5267, 5238, 3789, 7601, 4596, 206, 4080, 2132, 2213, 1906, 2017, 407, 575, 5223, 9646, 3296, 4046, 4647, 9664, 985, 8646, 9696, 1581, 8009, 9790, 2857, 5494, 5824, 3215, 2958, 8569, 8253, 3131, 8513, 8098, 3085, 8662, 6661, 8735, 408, 5765, 584, 6809, 256, 9182, 7724, 5123, 5040, 1243, 3760, 5288, 1311, 6319, 4050, 7246, 9104, 5553, 7778, 7718, 5075, 1755, 8008, 4335, 3268, 4675, 701, 7867, 175, 1454, 2990, 6710, 9476, 9744, 7686, 5826, 5379, 7379, 1882, 3266, 2205, 5205, 5094, 8064, 1065, 4819, 5492, 7009, 9368, 810, 9799, 4685, 6245, 9393, 1666, 5698, 8500, 6312, 8126, 5084, 9051, 2672, 2509, 1901, 9807, 6964, 8427, 6269, 7044, 7199, 7287, 6512, 7673, 621, 4784, 9168, 4959, 7410, 4782, 2595, 8086, 5875, 7880, 9090, 3821, 8244, 7949, 1564, 9342, 6501, 4018, 5669, 2714, 8628, 3041, 2934, 1385, 3639, 5274, 1128, 6773, 2920, 5181, 1352, 2753, 6676, 5200, 7289, 4013, 6, 7124, 1538, 1695, 6802, 4701, 1190, 4628, 3145, 9246, 2168, 564, 8913, 5782, 5476, 2462, 8907, 26, 1456, 7671, 3345, 8120, 7952, 2827, 3519, 2495, 5558, 9799, 7768, 150, 6957, 1798, 9965, 5626, 334, 1914, 7003, 901, 8789, 5180, 54, 5717, 7480, 5559, 6662, 4382, 5852, 2582, 3359, 6042, 1385, 2577, 3156, 6715, 8496, 9578, 3799, 5903, 6018, 9196, 1770, 5964, 2261, 3792, 5185, 9310, 3359, 9057, 4024, 6067, 4104, 8272, 3434, 8064, 9233, 292, 1778, 8519, 2395, 4095, 3674, 7897, 5733, 1198, 8363, 6928, 1504, 4901, 5379, 9112, 4707, 9737, 5727, 2206, 7351, 8172, 9433, 3387, 1815, 9551, 482, 7100, 4680, 9329, 8116, 2684, 4394, 1554, 5680, 8041, 5560, 7697, 5566, 8716, 3283, 2555, 8401, 357, 5524, 484, 7317, 1933, 5833, 3361, 893, 814, 9042, 3330, 9145, 6817, 7949, 4822, 7666, 3828, 6571, 3109, 5226, 8234, 5013, 7873, 4749, 9180, 695, 9870, 5027, 6150, 1316, 7340, 6276, 3684, 8456, 9233, 5902, 900, 4266, 5042, 5626, 3340, 1755, 2313, 2532, 6229, 2210, 2277, 440, 2619, 8231, 7211, 9626, 5276, 8390, 6310, 3330, 4735, 3277, 7705, 2396, 1167, 4040, 2392, 3639, 9992, 9805, 5603, 7393, 5737, 14, 5769, 9720, 5651, 6942, 5949, 6598, 5835, 3392, 557, 1672, 4763, 5047, 4579, 9973, 9381, 2642, 8915, 6209, 3305, 8141, 3400, 5629, 983, 5222, 4347, 3081, 8774}, 1806040));
    }

    //https://leetcode.com/problems/minimum-operations-to-reduce-x-to-zero/discuss/935935/Java-Detailed-Explanation-O(N)-Prefix-SumMap-Longest-Target-Sub-Array
    public static int minOperations(int[] nums, int x) {
        int target = -x;
        for (int num : nums) target += num;
        if (target == 0) return nums.length;  // since all elements are positive, we have to take all of them
        Map<Integer, Integer> map = new HashMap<>();
        map.put(0, -1);
        int sum = 0, len = nums.length, max = Integer.MIN_VALUE;
        for (int i = 0; i < len; i++) {
            sum += nums[i];
            if (map.containsKey(sum - target)) {
                max = Math.max(max, i - map.get(sum - target));
            }
            map.putIfAbsent(sum, i);
        }
        return max == Integer.MIN_VALUE ? -1 : len - max;
    }

    public static int minOperations_dfs(int[] nums, int x) {
        min = nums.length + 1;
        Set<String> visited = new HashSet<>();
        helper(0, nums.length - 1, 0, x, nums, visited);
        return min == nums.length + 1 ? -1 : min;
    }

    private static void helper(int s, int e, int ope, int x, int[] nums, Set<String> visited) {
        if (x == 0) {
            min = Math.min(min, ope);
        }
        if (ope > min || s > e || !visited.add(s + "" + e + "" + x)) return;
        if (s == e) {
            if (nums[s] == x) min = Math.min(min, ope + 1);
        }
        helper(s + 1, e, ope + 1, x - nums[s], nums, visited);
        helper(s, e - 1, ope + 1, x - nums[e], nums, visited);
    }

    public static int minOperations_bfs(int[] nums, int x) {
        Set<String> visited = new HashSet<>();
        Queue<int[]> queue = new LinkedList<>();
//        0: start, 1: end, 2 : x
        queue.add(new int[]{0, nums.length - 1, x});
        visited.add(getKey(0, nums.length - 1, x));
        int operations = 0;
        while (!queue.isEmpty()) {
            int size = queue.size();
            operations++;
            for (int i = 0; i < size; i++) {
                int[] poll = queue.poll();
                int s = poll[0], e = poll[1], val = poll[2];
                if (s > e) continue;
//                Try taking the first value
                if (val - nums[s] == 0 || val - nums[e] == 0) {
//                    System.out.println("poll = " + Arrays.toString(poll));
                    return operations;
                }
                if (val - nums[s] > 0 && visited.add(getKey(s + 1, e, val - nums[s])))
                    queue.add(new int[]{s + 1, e, val - nums[s]});
                if (val - nums[e] > 0 && visited.add(getKey(s, e - 1, val - nums[e])))
                    queue.add(new int[]{s, e - 1, val - nums[e]});
            }
        }
        return -1;
    }

    private static String getKey(int s, int e, int x) {
        return s + " - " + e + " = " + x;
    }
}
